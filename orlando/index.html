<!-- 
/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 *
 * 
 * This presentation can be used as a template for others if this header stays here.
 * 
 * Thank you, @shamakry for the awesome jmpress.js!!
 *
 */
-->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>WebGL for Baby Brains: Neuroimaging in the Browser</title>

	<meta name="viewport" content="width=device-width, maximum-scale=1.0, initial-scale=1.0, user-scalable=yes" />
	<meta name="author" content="Daniel Haehn, Children's Hospital Boston" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<link href="xmpress.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="x/xtk.js"></script>
  <script type="text/javascript" src="x/xtk_xdat.gui.js"></script>

	<script type="text/javascript" src="jquery/js/jquery-1.7.1.min.js"></script>
	<link id="theme" href="jquery/css/start/jquery-ui-1.8.18.custom.css" rel="stylesheet" />

	<script type="text/javascript" src="jmpress/jmpress.min.js"></script>
	<link href="jmpress/basic-animations.min.css" rel="stylesheet" type="text/css" />
	
  <script type="text/javascript" src="sh/shCore.js"></script>
  <script type="text/javascript" src="sh/shBrushJScript.js"></script>
  <link type="text/css" rel="stylesheet" href="sh/shCoreEmacs.css"/>
</head>
<body>

<div id="webglchb">
  <div id="home" class="step init-css" data-x=0>
    <div class="intro-top ui-state-default">
      <img src="gfx/chblogo.gif" style="position:absolute;bottom:200px;left:50%;">        
      <div class="inner">  
        <h1 class="standardtext">WebGL for Baby Brains:</h1>
      </div>
    </div>
    <div class="intro-bottom ui-state-default">
      <div class="inner">
        <h1 class="standardtext">Neuroimaging in the Browser</h1>
      </div>
    </div>
  </div>

	<div id="chbintro" class="step" data-x="0">
    <img src="gfx/chbentrance.jpg" width="100%" height="100%" style="position:absolute;left:0px;top:0px">
    <img src="gfx/chblobby.jpg" width="100%" height="100%" data-jmpress="expand" style="position:absolute;left:0px;top:0px">
    <img src="gfx/chbclowns.jpg" width="100%" height="100%" data-jmpress="expand" style="position:absolute;left:0px;top:0px">
    <video id="robotvid" data-jmpress="expand" preload="auto" src="gfx/foodbot.mp4" height="100%" autoplay="autoplay" controls="controls" style="position:absolute;left:0px;top:0px"></video>    
	</div>
	
	<div class="step" data-x="1000">
    Fetal-Neonatal Neuroimaging and Developmental Science Center
    <ul>
    <li>.. or short: <b>FNNDSC</b>
    <li>Interdisciplinary research group
	    <ul>
	    <li>Physicians, Psychologists, Physicists, Bio-Engineers..
	    </ul>
	  <li>Director: P. Ellen Grant, MD<br><br>&nbsp;&nbsp;&nbsp;<img src="gfx/ellen.jpg">
    </ul>
    <span style="position:absolute;right:90px;bottom:100px">
    <a href="http://childrenshospital.org/FNNDSC" target="_blank">http://childrenshospital.org/FNNDSC</a>
    <br>
    <a href="http://fnndsc.github.com" target="_blank">http://fnndsc.github.com</a>
    </span>
	</div>
	
	<div id="nrrds" class="step" data-src="x/nrrds.html" data-x="2000">
	  Loading...
	</div>
		
  <div id="braincamera" class="step" data-x="3000">
    <img src="gfx/braincamera2.jpg" height="100%" style="position:absolute;left:280px;top:0px">
    <img src="gfx/braincamera.jpg" height="100%" data-jmpress="expand" style="position:absolute;left:0px;top:0px">
    <img src="gfx/braincamera3.jpg" height="100%" data-jmpress="expand" style="position:absolute;right:0px;top:0px">
    <img src="gfx/coils.jpg" width="100%" height="100%" data-jmpress="expand" style="position:absolute;left:0px;top:0px">    
  </div>
  
	<div id="cube" class="step" data-x="4000">
	  <img src="gfx/mricube.png" height="100%" style="position:absolute;left:0px;top:0px;">
	</div>
	
  <div id="slicing0" class="step" data-src="x/slicing.html" data-x="5000">
    Loading...
  </div>	
  
  <div id="labeling" class="step" data-x="6000">
    Manual or Automatic Segmentation
    <img src="gfx/10mo_slice.png" style="position:absolute;left:80px;top:100px;">
    <img src="gfx/10mo_labels.png" style="position:absolute;right:80px;top:100px;">
  </div>  

  <div id="labeling2" class="step" data-src="x/labeling2.html" data-x="7000">
    Loading...
  </div>
  
  <div id="dti" class="step" data-x="8000">
    Diffusion Imaging
    <img src="gfx/diffusion.png" style="position:absolute;left:0px;width:100%;top:160px;">
  </div>  
  
  <div id="tracks" class="step" data-src="x/tracks.html" data-x="9000">
    Loading...
  </div>      
  
  <div id="software" class="step" data-x="10000">
    <img src="gfx/3dslicer.png" width="100%" height="100%" style="position:absolute;left:0px;top:0px">
    <img src="gfx/freeview.png" width="100%" height="100%" data-jmpress="expand" style="position:absolute;left:0px;top:0px">
    <img src="gfx/osirix.png" width="100%" height="100%" data-jmpress="expand" style="position:absolute;left:0px;top:0px">
    <img src="gfx/trackvis.png" width="100%" height="100%" data-jmpress="expand" style="position:absolute;left:0px;top:0px">
  </div>  
  
  <div id="browser" class="step" data-x="11000">
    How to bring it to the web?
    <ul>
      <li>Many WebGL frameworks exist but the learning curve is rather steep
      <li>Researchers don't want to deal with Computer Graphics methodologies ..
      <li>.. if they code, then only Matlab 
    </ul>
  </div>
  
  <div id="xtkintro" class="step" data-x="12000">
    The X Toolkit (XTK)
    <ul>
      <li>Simple Visualization API
      <li>Geared towards Scientific Visualization
      <ul>
        <li>Support for various common file formats (.stl, .vtk, .trk, .nrrd, .fsm)
      </ul>
      <li>Focus on Software Development Process (building+testing)
      <li>Open source, fully unrestricted
    </ul>
  </div>
  	
  <div id="slicing1" class="step" data-src="x/slicing2.html" data-x="13000">
    Loading...
  </div>  
  
  <div id="slicing1code" class="step" data-x="14000">
  The Code
    <pre class="brush: js;">
    renderer = new X.renderer('r');
    renderer.init();
    
    // load a .NRRD file to the X.volume
    // this works with gzip/gz/raw encoded NRRD files
    var volume = new X.volume();
    volume.load('data/10mo.nrrd');
    
    // .. add it
    renderer.add(volume);
    
    // showtime
    renderer.render();
    </pre>  
  </div>
  
  <div id="surfacemodel" class="step" data-src="x/surfacemodel.html" data-x="15000">
  Loading...
  </div>

  <div id="surfacemodel2" class="step" data-x="16000">
    <pre class="brush: js;">
// create a new renderer
r5 = new X.renderer('r5');
r5.init();

// load a .vtk file
var model = new X.object();
model.load('data/Model_42_42.vtk');
model.setColor(0.7,0.7,0);

// .. add it
r5.add(model);

// and showtime!
r5.render();
</pre>
  </div>
  
  <div id="tracks2" class="step" data-src="x/tracks.html" data-x="17000">
  Loading...
  </div>      
  
  <div id="tracks2code" class="step" data-x="18000">
  The Code
		<pre class="brush: js;">
// create a new renderer
r1 = new X.renderer('r1');
r1.init();

// load a .trk file
fibers = new X.object();
fibers.load('data/cc_tracks.trk');

// add the object
r1.add(fibers);

// .. and render it
r1.render();
</pre>
  </div>
  
  <div id="tracks_meshes" class="step" data-src="x/tracks_meshes.html" data-x="19000">
    Loading...
  </div>
  
  <div id="slicer_exporter" class="step" data-x="20000">
	  <img src="gfx/slicerexport1.png" width="100%" style="position:absolute;left:0px;top:50px">
	  <img src="gfx/slicerexport2.png" width="100%" data-jmpress="expand" style="position:absolute;left:0px;top:50px">
	  <img src="gfx/slicerexport3.png" width="100%" data-jmpress="expand" style="position:absolute;left:0px;top:50px">
  </div>

  <div id="closurecompiler" class="step" data-x="21000">
    <img src="gfx/closurecompiler.png" style="position:absolute;right:50px;top:50px;">
    Google Closure Library
    <ul>
      <li>dependency mechanism
      <li>great event system
      <li>easy object inheritance
      <li>unit tests
    </ul>
    Google Closure Compiler
    <ul>
      <li>code check
      <li>advanced compilation (super minified code)
    </ul>
  </div>
  
  <div id="getgoxtk" class="step" data-x="22000">
    <img src="gfx/getgoxtk.png" width="100%" style="position:absolute;left:0px;top:100px">
  </div>  

  <div id="buildsystem" class="step" data-x="23000">
    <img src="gfx/build1.png" width="100%" style="position:absolute;left:0px;top:100px">
    <img src="gfx/build2.png" width="100%" style="position:absolute;left:0px;top:250px">
  </div>  
  
  <div id="cdash" class="step" data-x="24000">
    <img src="gfx/cdashgoxtk.png" width="100%" style="position:absolute;left:0px;top:0px">
  </div> 
  
  <div id="apidoc" class="step" data-x="25000">
    <img src="gfx/apigoxtk.png" height="100%" style="position:absolute;left:60px;top:0px">
  </div>  
  
  <div id="challenges" class="step" data-x="26000">
    Challenges: File I/O
    <ul>
      <li>data can be huge (~100 MB)
      <li>different coordinate systems (RAS, LPS..)
      <li>some require partial or full unzipping
      <ul>
        <li> JXG's unzip library works well but is slow
      </ul>
    </ul>
  </div>    
  
  <div id="challenges2" class="step" data-x="27000">
    Challenges: Transparency/Blending
    <ul>
      <li>depth ordering required
      <ul>
        <li>implemented object based depth ordering
        <li>performance is good but artifacts appear
      </ul>
      <li>depth peeling?
      <li>other suggestions?
    </ul>
  </div>    
    
  <div id="challenges3" class="step" data-x="28000">
    Challenges: Performance
    <ul>
      <li>optimized loops
      <ul>
        <li>Fast Duffs Device
      </ul>
      <li>internally only object property access without validation
      <li>caching, hash maps
    </ul>
  </div>      
  
  <div id="demos" class="step" data-x="29000">
    <div style="text-align:center;line-height:500px">Demos</div>
    <div style="text-align:center;font-size:0.8em;"><a href="http://goXTK.com" target=_blank>http://goXTK.com</a></div>
  </div> 
  
  <div id="thank you" class="step" data-x="30000">
    <div style="text-align:center;line-height:500px">Thank you!</div>
    <div style="text-align:center;font-size:0.8em;"><a href="http://babyMRI.org/orlando/" target=_blank>http://babyMRI.org/orlando/</a></div>
  </div>  
    
</div>

<script type="text/javascript">

setTimeout(function() {
  $("#home").removeClass("init-css");
}, 500);

$(function() {
	$('#webglchb').jmpress();
});

$(document).keypress(function(e) {
  
  var currentStepId = $('#webglchb').jmpress('active')[0].id;
  
  // play the robot video on enter
  var code = (e.keyCode ? e.keyCode : e.which);
  if (code==13) {
    if (currentStepId == 'nrrds') {
      adjustThreshold();
    } else if (currentStepId == 'chbintro') {
      $('#robotvid').get(0).play();
    }
    
  }
  
});

SyntaxHighlighter.all();
</script>

</body>
</html>