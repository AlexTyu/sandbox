/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function g(a){throw a;}var n=void 0,p=!0,q=null,r=!1;function aa(){return function(){}}function da(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}var w,ea=this;function fa(){}
function ga(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ia(a){return a!==n}function x(a){return a!=q}function ja(a){return"array"==ga(a)}function ka(a){var b=ga(a);return"array"==b||"object"==b&&"number"==typeof a.length}function y(a){return"string"==typeof a}function z(a){return"number"==typeof a}function ma(a){return"function"==ga(a)}function na(a){a=ga(a);return"object"==a||"array"==a||"function"==a}function oa(a){return a[qa]||(a[qa]=++ra)}
var qa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ra=0;function ta(a,b,c){return a.call.apply(a.bind,arguments)}function ua(a,b,c){a||g(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function va(a,b,c){va=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:ua;return va.apply(q,arguments)}function wa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var xa=Date.now||function(){return+new Date};
function B(a,b){var c=a.split("."),d=ea;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&ia(b)?d[f]=b:d=d[f]?d[f]:d[f]={}}function C(a,b){function c(){}c.prototype=b.prototype;a.D=b.prototype;a.prototype=new c};window["X.Counter"]=function(){var a=0;return{Gd:function(){a+=1},Mh:function(){a+=-1},value:function(){return a}}}();
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return e.apply(this instanceof c?this:a||window,f.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&g(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,f=d.call(arguments,1),e=this;c.prototype=this.prototype;b.prototype=new c;return b});B("Function.prototype.bind",Function.prototype.bind);function ya(a){if(!za.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Aa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ba,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ca,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Da,"&quot;"));return a}var Aa=/&/g,Ba=/</g,Ca=/>/g,Da=/\"/g,za=/[&<>\"]/;var Ea,Fa,Ga,Ha,Ia,Ja,La;function Ma(){return ea.navigator?ea.navigator.userAgent:q}function Na(){return ea.navigator}Ia=Ha=Ga=Fa=Ea=r;var Oa;if(Oa=Ma()){var Pa=Na();Ea=0==Oa.indexOf("Opera");Fa=!Ea&&-1!=Oa.indexOf("MSIE");Ha=(Ga=!Ea&&-1!=Oa.indexOf("WebKit"))&&-1!=Oa.indexOf("Mobile");Ia=!Ea&&!Ga&&"Gecko"==Pa.product}var Qa=Ea,F=Fa,Ra=Ia,H=Ga,Sa=Ha,Ta,Ua=Na();Ta=Ua&&Ua.platform||"";Ja=-1!=Ta.indexOf("Mac");La=-1!=Ta.indexOf("Win");var Va=!!Na()&&-1!=(Na().appVersion||"").indexOf("X11"),Wa;
a:{var Xa="",Ya;if(Qa&&ea.opera)var Za=ea.opera.version,Xa="function"==typeof Za?Za():Za;else if(Ra?Ya=/rv\:([^\);]+)(\)|;)/:F?Ya=/MSIE\s+([^\);]+)(\)|;)/:H&&(Ya=/WebKit\/(\S+)/),Ya)var $a=Ya.exec(Ma()),Xa=$a?$a[1]:"";if(F){var bb,cb=ea.document;bb=cb?cb.documentMode:n;if(bb>parseFloat(Xa)){Wa=""+bb;break a}}Wa=Xa}var db={};
function eb(a){var b;if(!(b=db[a])){b=0;for(var c=(""+Wa).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(c.length,d.length),e=0;0==b&&e<f;e++){var h=c[e]||"",i=d[e]||"",j=RegExp("(\\d*)(\\D*)","g"),o=RegExp("(\\d*)(\\D*)","g");do{var k=j.exec(h)||["","",""],m=o.exec(i)||["","",""];if(0==k[0].length&&0==m[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==m[1].length?0:parseInt(m[1],10))?-1:(0==k[1].length?0:parseInt(k[1],
10))>(0==m[1].length?0:parseInt(m[1],10))?1:0)||((0==k[2].length)<(0==m[2].length)?-1:(0==k[2].length)>(0==m[2].length)?1:0)||(k[2]<m[2]?-1:k[2]>m[2]?1:0)}while(0==b)}b=db[a]=0<=b}return b}var fb={};function gb(a){return fb[a]||(fb[a]=F&&document.documentMode&&document.documentMode>=a)};function hb(a,b){for(var c in a)b.call(n,a[c],c,a)}function ib(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function kb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var lb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function mb(a,b){for(var c,d,f=1;f<arguments.length;f++){d=arguments[f];for(c in d)a[c]=d[c];for(var e=0;e<lb.length;e++)c=lb[e],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var nb=Array.prototype,ob=nb.indexOf?function(a,b,c){return nb.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(y(a))return!y(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},pb=nb.forEach?function(a,b,c){nb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=y(a)?a.split(""):a,e=0;e<d;e++)e in f&&b.call(c,f[e],e,a)},qb=nb.map?function(a,b,c){return nb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=Array(d),e=y(a)?
a.split(""):a,h=0;h<d;h++)h in e&&(f[h]=b.call(c,e[h],h,a));return f},rb=nb.some?function(a,b,c){return nb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=y(a)?a.split(""):a,e=0;e<d;e++)if(e in f&&b.call(c,f[e],e,a))return p;return r},sb=nb.every?function(a,b,c){return nb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=y(a)?a.split(""):a,e=0;e<d;e++)if(e in f&&!b.call(c,f[e],e,a))return r;return p};function tb(a,b){var c=ob(a,b);0<=c&&nb.splice.call(a,c,1)}
function ub(a){return nb.concat.apply(nb,arguments)}function vb(a){if(ja(a))return ub(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function wb(a,b,c){return 2>=arguments.length?nb.slice.call(a,b):nb.slice.call(a,b,c)};function xb(a){if("function"==typeof a.N)a=a.N();else if(ka(a)||y(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function yb(a){if("function"==typeof a.fa)return a.fa();if(y(a))return a.split("");if(ka(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return ib(a)}
function zb(a,b){if("function"==typeof a.every)return a.every(b,n);if(ka(a)||y(a))return sb(a,b,n);var c;if("function"==typeof a.Xb)c=a.Xb();else if("function"!=typeof a.fa)if(ka(a)||y(a)){c=[];for(var d=a.length,f=0;f<d;f++)c.push(f)}else c=kb(a);else c=n;for(var d=yb(a),f=d.length,e=0;e<f;e++)if(!b.call(n,d[e],c&&c[e],a))return r;return p};var Ab="StopIteration"in ea?ea.StopIteration:Error("StopIteration");function Bb(){}Bb.prototype.next=function(){g(Ab)};Bb.prototype.Cb=function(){return this};function Cb(a){if(a instanceof Bb)return a;if("function"==typeof a.Cb)return a.Cb(r);if(ka(a)){var b=0,c=new Bb;c.next=function(){for(;;){b>=a.length&&g(Ab);if(b in a)return a[b++];b++}};return c}g(Error("Not implemented"))}
function Db(a,b){if(ka(a))try{pb(a,b,n)}catch(c){c!==Ab&&g(c)}else{a=Cb(a);try{for(;;)b.call(n,a.next(),n,a)}catch(d){d!==Ab&&g(d)}}};function Eb(a,b){this.q={};this.n=[];var c=arguments.length;if(1<c){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.sd(a)}w=Eb.prototype;w.g=0;w.lc=0;w.N=s("g");w.fa=function(){Hb(this);for(var a=[],b=0;b<this.n.length;b++)a.push(this.q[this.n[b]]);return a};w.Xb=function(){Hb(this);return this.n.concat()};w.wd=function(a){for(var b=0;b<this.n.length;b++){var c=this.n[b];if(Ib(this.q,c)&&this.q[c]==a)return p}return r};
w.Tb=function(a,b){if(this===a)return p;if(this.g!=a.N())return r;var c=b||Jb;Hb(this);for(var d,f=0;d=this.n[f];f++)if(!c(this.get(d),a.get(d)))return r;return p};function Jb(a,b){return a===b}w.clear=function(){this.q={};this.lc=this.g=this.n.length=0};w.remove=function(a){return Ib(this.q,a)?(delete this.q[a],this.g--,this.lc++,this.n.length>2*this.g&&Hb(this),p):r};
function Hb(a){if(a.g!=a.n.length){for(var b=0,c=0;b<a.n.length;){var d=a.n[b];Ib(a.q,d)&&(a.n[c++]=d);b++}a.n.length=c}if(a.g!=a.n.length){for(var f={},c=b=0;b<a.n.length;)d=a.n[b],Ib(f,d)||(a.n[c++]=d,f[d]=1),b++;a.n.length=c}}w.get=function(a,b){return Ib(this.q,a)?this.q[a]:b};w.set=function(a,b){Ib(this.q,a)||(this.g++,this.n.push(a),this.lc++);this.q[a]=b};w.sd=function(a){var b;a instanceof Eb?(b=a.Xb(),a=a.fa()):(b=kb(a),a=ib(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};w.d=function(){return new Eb(this)};
w.Cb=function(a){Hb(this);var b=0,c=this.n,d=this.q,f=this.lc,e=this,h=new Bb;h.next=function(){for(;;){f!=e.lc&&g(Error("The map has changed since the iterator was created"));b>=c.length&&g(Ab);var h=c[b++];return a?h:d[h]}};return h};function Ib(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Kb(a){this.q=new Eb;a&&this.sd(a)}function Lb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+oa(a):b.substr(0,1)+a}w=Kb.prototype;w.N=function(){return this.q.N()};w.add=function(a){this.q.set(Lb(a),a)};w.sd=function(a){for(var a=yb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};w.Rc=function(a){for(var a=yb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};w.remove=function(a){return this.q.remove(Lb(a))};w.clear=function(){this.q.clear()};
w.contains=function(a){a=Lb(a);return Ib(this.q.q,a)};w.Fe=function(a){for(var b=new Kb,a=yb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};w.fa=function(){return this.q.fa()};w.d=function(){return new Kb(this)};w.Tb=function(a){return this.N()==xb(a)&&Mb(this,a)};
function Mb(a,b){var c=xb(b);if(a.N()>c)return r;!(b instanceof Kb)&&5<c&&(b=new Kb(b));return zb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.wd)a=b.wd(a);else if(ka(b)||y(b))a=0<=ob(b,a);else a:{for(var c in b)if(b[c]==a){a=p;break a}a=r}return a})}w.Cb=function(){return this.q.Cb(r)};function Nb(){}Nb.prototype.se=r;Nb.prototype.ea=function(){this.se||(this.se=p,this.u())};Nb.prototype.u=function(){this.Kf&&Ob.apply(q,this.Kf)};function Pb(a){a&&"function"==typeof a.ea&&a.ea()}function Ob(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ka(d)?Ob.apply(q,d):Pb(d)}};function Qb(a,b){this.Le=b;this.Wb=[];a>this.Le&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Wb.push(this.Ac())}C(Qb,Nb);w=Qb.prototype;w.pe=q;w.re=q;function Rb(a,b){a.Wb.length<a.Le?a.Wb.push(b):a.Ad(b)}w.Ac=function(){return this.pe?this.pe():{}};w.Ad=function(a){if(this.re)this.re(a);else if(na(a))if(ma(a.ea))a.ea();else for(var b in a)delete a[b]};w.u=function(){Qb.D.u.call(this);for(var a=this.Wb;a.length;)this.Ad(a.pop());delete this.Wb};function Sb(){this.Ub=[];this.Qd=new Eb;this.mf=this.nf=this.of=this.gf=0;this.kc=new Eb;this.me=this.lf=0;this.Md=1;this.Bd=new Qb(0,4E3);this.Bd.Ac=function(){return new Tb};this.hf=new Qb(0,50);this.hf.Ac=function(){return new Ub};var a=this;this.Ed=new Qb(0,2E3);this.Ed.Ac=function(){return""+a.Md++};this.Ed.Ad=aa()}function Ub(){this.Zd=this.time=this.count=0}
Ub.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.Zd&&a.push(" [VarAlloc = ",this.Zd,"]");return a.join("")};function Tb(){}function Vb(a,b,c,d){var f=[];-1==c?f.push("    "):f.push(Wb(a.ue-c));f.push(" ",Xb(a.ue-b));0==a.Cd?f.push(" Start        "):1==a.Cd?(f.push(" Done "),f.push(Wb(a.Qh-a.startTime)," ms ")):f.push(" Comment      ");f.push(d,a);0<a.eh&&f.push("[VarAlloc ",a.eh,"] ");return f.join("")}
Tb.prototype.toString=function(){return this.type==q?this.If:"["+this.type+"] "+this.If};Sb.prototype.reset=function(){for(var a=0;a<this.Ub.length;a++){var b=this.Bd.id;b&&Rb(this.Ed,b);Rb(this.Bd,this.Ub[a])}this.Ub.length=0;this.Qd.clear();this.gf=xa();this.me=this.lf=this.mf=this.nf=this.of=0;b=this.kc.Xb();for(a=0;a<b.length;a++){var c=this.kc.get(b[a]);c.count=0;c.time=0;c.Zd=0;Rb(this.hf,c)}this.kc.clear()};
Sb.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Ub.length;d++){var f=this.Ub[d];1==f.Cd&&c.pop();a.push(" ",Vb(f,this.gf,b,c.join("")));b=f.ue;a.push("\n");0==f.Cd&&c.push("|  ")}if(0!=this.Qd.N()){var e=xa();a.push(" Unstopped timers:\n");Db(this.Qd,function(b){a.push("  ",b," (",e-b.startTime," ms, started at ",Xb(b.startTime),")\n")})}b=this.kc.Xb();for(d=0;d<b.length;d++)c=this.kc.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.lf,"\n","Total comments created ",
this.me,"\n","Overhead start: ",this.of," ms\n","Overhead end: ",this.nf," ms\n","Overhead comment: ",this.mf," ms\n");return a.join("")};function Wb(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Xb(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new Sb;function Yb(){}var Zb=0;w=Yb.prototype;w.key=0;w.wb=r;w.td=r;w.xa=function(a,b,c,d,f,e){ma(a)?this.Ge=p:a&&a.handleEvent&&ma(a.handleEvent)?this.Ge=r:g(Error("Invalid listener argument"));this.bc=a;this.$e=b;this.src=c;this.type=d;this.capture=!!f;this.Dd=e;this.td=r;this.key=++Zb;this.wb=r};w.handleEvent=function(a){return this.Ge?this.bc.call(this.Dd||this.src,a):this.bc.handleEvent.call(this.bc,a)};!F||gb(9);var $b=!F||gb(9),ac=F&&!eb("8");!H||eb("528");Ra&&eb("1.9b")||F&&eb("8")||Qa&&eb("9.5")||H&&eb("528");!Ra||eb("8");function bc(a,b){this.type=a;this.currentTarget=this.target=b}C(bc,Nb);w=bc.prototype;w.u=function(){delete this.type;delete this.target;delete this.currentTarget};w.gb=r;w.gc=p;w.stopPropagation=function(){this.gb=p};w.preventDefault=function(){this.gc=r};function cc(a){cc[" "](a);return a}cc[" "]=fa;function dc(a,b){a&&this.xa(a,b)}C(dc,bc);w=dc.prototype;w.target=q;w.relatedTarget=q;w.offsetX=0;w.offsetY=0;w.clientX=0;w.clientY=0;w.screenX=0;w.screenY=0;w.button=0;w.keyCode=0;w.charCode=0;w.ctrlKey=r;w.altKey=r;w.shiftKey=r;w.metaKey=r;w.ma=q;
w.xa=function(a,b){var c=this.type=a.type;bc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ra){var f;a:{try{cc(d.nodeName);f=p;break a}catch(e){}f=r}f||(d=q)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=H||a.offsetX!==n?a.offsetX:a.layerX;this.offsetY=H||a.offsetY!==n?a.offsetY:a.layerY;this.clientX=a.clientX!==n?a.clientX:a.pageX;this.clientY=a.clientY!==n?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.ma=a;delete this.gc;delete this.gb};w.stopPropagation=function(){dc.D.stopPropagation.call(this);this.ma.stopPropagation?this.ma.stopPropagation():this.ma.cancelBubble=p};
w.preventDefault=function(){dc.D.preventDefault.call(this);var a=this.ma;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,ac)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};w.Tf=s("ma");w.u=function(){dc.D.u.call(this);this.relatedTarget=this.currentTarget=this.target=this.ma=q};var ec={},gc={},hc={},ic={};
function J(a,b,c,d,f){if(b){if(ja(b)){for(var e=0;e<b.length;e++)J(a,b[e],c,d,f);return q}var d=!!d,h=gc;b in h||(h[b]={g:0,Y:0});h=h[b];d in h||(h[d]={g:0,Y:0},h.g++);var h=h[d],i=oa(a),j;h.Y++;if(h[i]){j=h[i];for(e=0;e<j.length;e++)if(h=j[e],h.bc==c&&h.Dd==f){if(h.wb)break;return j[e].key}}else j=h[i]=[],h.g++;e=jc();e.src=a;h=new Yb;h.xa(c,e,a,b,d,f);c=h.key;e.key=c;j.push(h);ec[c]=h;hc[i]||(hc[i]=[]);hc[i].push(h);a.addEventListener?(a==ea||!a.qe)&&a.addEventListener(b,e,d):a.attachEvent(b in
ic?ic[b]:ic[b]="on"+b,e);return c}g(Error("Invalid event type"))}function jc(){var a=kc,b=$b?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function lc(a,b,c,d,f){if(ja(b))for(var e=0;e<b.length;e++)lc(a,b[e],c,d,f);else a=J(a,b,c,d,f),ec[a].td=p}
function mc(a,b,c,d,f){if(ja(b))for(var e=0;e<b.length;e++)mc(a,b[e],c,d,f);else{d=!!d;a:{e=gc;if(b in e&&(e=e[b],d in e&&(e=e[d],a=oa(a),e[a]))){a=e[a];break a}a=q}if(a)for(e=0;e<a.length;e++)if(a[e].bc==c&&a[e].capture==d&&a[e].Dd==f){nc(a[e].key);break}}}
function nc(a){if(!ec[a])return r;var b=ec[a];if(b.wb)return r;var c=b.src,d=b.type,f=b.$e,e=b.capture;c.removeEventListener?(c==ea||!c.qe)&&c.removeEventListener(d,f,e):c.detachEvent&&c.detachEvent(d in ic?ic[d]:ic[d]="on"+d,f);c=oa(c);f=gc[d][e][c];if(hc[c]){var h=hc[c];tb(h,b);0==h.length&&delete hc[c]}b.wb=p;f.Pe=p;oc(d,e,c,f);delete ec[a];return p}
function oc(a,b,c,d){if(!d.Lc&&d.Pe){for(var f=0,e=0;f<d.length;f++)d[f].wb?d[f].$e.src=q:(f!=e&&(d[e]=d[f]),e++);d.length=e;d.Pe=r;0==e&&(delete gc[a][b][c],gc[a][b].g--,0==gc[a][b].g&&(delete gc[a][b],gc[a].g--),0==gc[a].g&&delete gc[a])}}function pc(a){var b,c=0,d=b==q;b=!!b;if(a==q)hb(hc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)nc(f.key),c++}});else if(a=oa(a),hc[a])for(var a=hc[a],f=a.length-1;0<=f;f--){var e=a[f];if(d||b==e.capture)nc(e.key),c++}}
function qc(a){var b=rc,a=oa(a),c=hc[a];if(c){var d=ia(b),f=ia(n);return d&&f?(c=gc[b],!!c&&!!c[n]&&a in c[n]):!d&&!f?p:rb(c,function(a){return d&&a.type==b||f&&a.capture==n})}return r}function sc(a,b,c,d,f){var e=1,b=oa(b);if(a[b]){a.Y--;a=a[b];a.Lc?a.Lc++:a.Lc=1;try{for(var h=a.length,i=0;i<h;i++){var j=a[i];j&&!j.wb&&(e&=tc(j,f)!==r)}}finally{a.Lc--,oc(c,d,b,a)}}return Boolean(e)}function tc(a,b){var c=a.handleEvent(b);a.td&&nc(a.key);return c}
function kc(a,b){if(!ec[a])return p;var c=ec[a],d=c.type,f=gc;if(!(d in f))return p;var f=f[d],e,h;if(!$b){var i;if(!(i=b))a:{i=["window","event"];for(var j=ea;e=i.shift();)if(x(j[e]))j=j[e];else{i=q;break a}i=j}e=i;i=p in f;j=r in f;if(i){if(0>e.keyCode||e.returnValue!=n)return p;a:{var o=r;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(k){o=p}if(o||e.returnValue==n)e.returnValue=p}}o=new dc;o.xa(e,this);e=p;try{if(i){for(var m=[],l=o.currentTarget;l;l=l.parentNode)m.push(l);h=f[p];h.Y=h.g;for(var t=
m.length-1;!o.gb&&0<=t&&h.Y;t--)o.currentTarget=m[t],e&=sc(h,m[t],d,p,o);if(j){h=f[r];h.Y=h.g;for(t=0;!o.gb&&t<m.length&&h.Y;t++)o.currentTarget=m[t],e&=sc(h,m[t],d,r,o)}}else e=tc(c,o)}finally{m&&(m.length=0),o.ea()}return e}d=new dc(b,this);try{e=tc(c,d)}finally{d.ea()}return e}var uc=0;function vc(a){return a+"_"+uc++};function K(a){bc.call(this,a);this._className="event"}C(K,bc);var wc=vc("pan"),xc=vc("rotate"),yc=vc("zoom"),zc=vc("render"),Ac=vc("resetview"),rc=vc("modified"),Bc=vc("progress"),Cc=vc("hover"),Dc=vc("hover_end");function Ec(){K.call(this,wc);this.jb=new Hc(0,0)}C(Ec,K);function Ic(){K.call(this,xc);this.jb=new Hc(0,0)}C(Ic,K);function Jc(){K.call(this,yc);this.Ca=this.Xa=r}C(Jc,K);function Kc(){K.call(this,zc)}C(Kc,K);function Lc(){K.call(this,Cc);this.zc=this.yc=0}C(Lc,K);
function Mc(){K.call(this,Dc)}C(Mc,K);function Nc(){K.call(this,Ac)}C(Nc,K);function Oc(){K.call(this,rc);this.ba=new L}C(Oc,K);function Pc(){K.call(this,Bc);this.ie=0}C(Pc,K);function Qc(a,b,c){this.x=ia(a)?a:0;this.y=ia(b)?b:0;this.b=ia(c)?c:0}Qc.prototype.d=function(){return new Qc(this.x,this.y,this.b)};Qc.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.b+")"};Qc.prototype.kf=function(){return[this.x,this.y,this.b]};function P(a,b,c){this.x=a;this.y=b;this.b=c}C(P,Qc);w=P.prototype;w.d=function(){return new P(this.x,this.y,this.b)};w.eb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};w.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};w.C=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};w.normalize=function(){return this.scale(1/this.eb())};w.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
w.pa=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};w.Tb=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Rc(a,b){var c=a.x-b.x,d=a.y-b.y,f=a.b-b.b;return Math.sqrt(c*c+d*d+f*f)}function Sc(a,b){return new P(a.x+b.x,a.y+b.y,a.b+b.b)}function Tc(a,b){return new P(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Uc(){}C(Uc,Nb);w=Uc.prototype;w.qe=p;w.Nc=q;w.Ud=da("Nc");w.addEventListener=function(a,b,c,d){J(this,a,b,c,d)};w.removeEventListener=function(a,b,c,d){mc(this,a,b,c,d)};
w.dispatchEvent=function(a){var b=a.type||a,c=gc;if(b in c){if(y(a))a=new bc(a,this);else if(a instanceof bc)a.target=a.target||this;else{var d=a,a=new bc(b,this);mb(a,d)}var d=1,f,c=c[b],b=p in c,e;if(b){f=[];for(e=this;e;e=e.Nc)f.push(e);e=c[p];e.Y=e.g;for(var h=f.length-1;!a.gb&&0<=h&&e.Y;h--)a.currentTarget=f[h],d&=sc(e,f[h],a.type,p,a)&&a.gc!=r}if(r in c)if(e=c[r],e.Y=e.g,b)for(h=0;!a.gb&&h<f.length&&e.Y;h++)a.currentTarget=f[h],d&=sc(e,f[h],a.type,r,a)&&a.gc!=r;else for(f=this;!a.gb&&f&&e.Y;f=
f.Nc)a.currentTarget=f,d&=sc(e,f,a.type,r,a)&&a.gc!=r;a=Boolean(d)}else a=p;return a};w.u=function(){Uc.D.u.call(this);pc(this);this.Nc=q};function Q(){this._className="base";this.c=r}C(Q,Uc);Q.prototype.className=s("_className");Q.prototype.print=function(){var a=Object.keys(this),b="",c="<unknown>",d=0;for(d in a){var f="this."+a[d],e=eval(f);"this._className"==f?c=e:b+=f+": "+e+"\n"}return"== X."+c+" ==\n"+b};Q.prototype.Nf=s("c");function Vc(a){a.c=r}B("X.base",Q);B("X.base.prototype.className",Q.prototype.className);B("X.base.prototype.print",Q.prototype.print);B("X.base.prototype.dirty",Q.prototype.Nf);function R(a){Q.call(this);this._className="triplets";this.Ha=this.Ka=this.Ga=this.Ja=this.Fa=this.Ia=q;this.mc=[0,0,0];this.X=[];x(a)&&a instanceof R&&(this.X=a.all().slice(),this.Ia=a.Ia,this.Fa=a.Fa,this.Ja=a.Ja,this.Ga=a.Ga,this.Ka=a.Ka,this.Ha=a.Ha,this.mc=a.mc.slice())}C(R,Q);w=R.prototype;
w.add=function(a,b,c){(!z(a)||!z(b)||!z(c))&&g(Error("Invalid triplet."));if(!this.Ia||a<this.Ia)this.Ia=a;if(!this.Fa||a>this.Fa)this.Fa=a;if(!this.Ja||b<this.Ja)this.Ja=b;if(!this.Ga||b>this.Ga)this.Ga=b;if(!this.Ka||c<this.Ka)this.Ka=c;if(!this.Ha||c>this.Ha)this.Ha=c;this.mc=[(this.Ia+this.Fa)/2,(this.Ja+this.Ga)/2,(this.Ka+this.Ha)/2];this.c=p;return this.X.push(a,b,c)/3};w.get=function(a){(!z(a)||3*a>this.X.length)&&g(Error("Invalid id."));a*=3;return[this.X[a],this.X[a+1],this.X[a+2]]};
w.remove=function(a){(!z(a)||3*a>this.X.length)&&g(Error("Invalid id."));this.X.splice(a,3);this.c=p};w.all=s("X");w.clear=function(){this.X=[];this.c=p};w.count=function(){return this.X.length/3};w.length=function(){return this.X.length};B("X.triplets",R);B("X.triplets.prototype.add",R.prototype.add);B("X.triplets.prototype.get",R.prototype.get);B("X.triplets.prototype.remove",R.prototype.remove);B("X.triplets.prototype.all",R.prototype.all);B("X.triplets.prototype.clear",R.prototype.clear);
B("X.triplets.prototype.count",R.prototype.count);B("X.triplets.prototype.length",R.prototype.length);function Wc(){Q.call(this);this._className="parser"}C(Wc,Q);w=Wc.prototype;w.parse=function(){g(Error("The function parse() should be overloaded."))};w.ec=function(a,b){var c=this.t(a,b+2),d=this.t(a,b+3),f=(d<<1&255|c>>7)-127,c=(c&127)<<16|this.t(a,b+1)<<8|this.t(a,b);return 0==c&&-127==f?0:(1-2*(d>>7))*(1+c*Math.pow(2,-23))*Math.pow(2,f)};
function Xc(a,b,c){var d=a.t(b,c),f=a.t(b,c+1),e=(d<<1&255|f>>7)-127,a=(f&127)<<16|a.t(b,c+2)<<8|a.t(b,c+3);return 0==a&&-127==e?0:(1-2*(d>>7))*(1+a*Math.pow(2,-23))*Math.pow(2,e)}function Yc(a,b,c,d){var f=[],e=0,h=Infinity,i;for(i=0;i<d;i++){var j=a.ec(b,c+4*i);f[i]=j;e=Math.max(e,j);h=Math.min(h,j)}return[f,e,h]}function Zc(a,b,c){return(a.t(b,c+3)<<24)+(a.t(b,c+2)<<16)+(a.t(b,c+1)<<8)+a.t(b,c)}function $c(a,b,c){return(a.t(b,c)<<24)+(a.t(b,c+1)<<16)+(a.t(b,c+2)<<8)+a.t(b,c+3)}
w.Qc=function(a,b){return(this.t(a,b+1)<<8)+this.t(a,b)};w.Bg=function(a,b){var c=this.t(a,b);return 127<c?c-256:c};w.t=function(a,b){return a.charCodeAt(b)&255};function ad(){Wc.call(this);this._className="parserTRK"}C(ad,Wc);
ad.prototype.parse=function(a,b){var c=a.k,d=a.p,f=a.$,e=0,h=e+6,i=0,j=Infinity,o;for(o=0;3>o;o++)var k=this.Qc(b,h+2*o),i=Math.max(i,k),j=Math.min(j,k);var m=Yc(this,b,e+12,3)[0];Yc(this,b,e+24,3);var l=this.Qc(b,e+36),t=this.Qc(b,e+238);Yc(this,b,e+440,16);Yc(this,b,e+956,6);for(var h=Zc(this,b,e+988),e=Zc(this,b,e+996),i=[],u=q,v=q,E=q,D=q,I=k=q,j=0;j<h;j++){var G=Zc(this,b,e),A=new R,e=e+4;for(o=0;o<G;o++){var N=this.ec(b,e),e=e+4,ba=this.ec(b,e),e=e+4,ha=this.ec(b,e),e=e+4;0<l&&(Yc(this,b,e,
l),e+=4*l);N/=m[0];ba/=m[1];ha/=m[2];A.add(N,ba,ha)}0<t&&(e+=4*t);o=A.Ia;var G=A.Fa,N=A.Ja,ba=A.Ga,ha=A.Ka,jb=A.Ha;if(!u||o<u)u=o;if(!v||G>v)v=G;if(!E||N<E)E=N;if(!D||ba>D)D=ba;if(!k||ha<k)k=ha;if(!I||jb>I)I=jb;i.push(A)}e=(u+v)/2;E=(E+D)/2;k=(k+I)/2;for(j=0;j<h;j++){I=i[j];D=I.count();for(o=0;o<D-1;o++)l=I.get(o),m=I.get(o+1),c.add(l[0],l[1],l[2]),c.add(m[0],m[1],m[2]),t=l[0]-e,u=l[1]-E,v=l[2]-k,A=Math.sqrt(t*t+u*u+v*v),G=m[0]-e,N=m[1]-E,ba=m[2]-k,ha=Math.sqrt(G*G+N*N+ba*ba),d.add(t/A,u/A,v/A),d.add(G/
ha,N/ha,ba/ha),m=[Math.abs(m[0]-l[0]),Math.abs(m[1]-l[1]),Math.abs(m[2]-l[2])],l=Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]),m[0]/=l,m[1]/=l,m[2]/=l,f.add(m[0],m[1],m[2]),f.add(m[0],m[1],m[2])}a.yb(bd);c=new Oc;c.ba=a;this.dispatchEvent(c)};B("X.parserTRK",ad);B("X.parserTRK.prototype.parse",ad.prototype.parse);function cd(){Wc.call(this);this._className="parserSTL"}C(cd,Wc);cd.prototype.parse=function(a,b){for(var c=b.split("\n"),d=c.length,f=a.k,e=a.p,h=0,i=d%8;i--;)this.A(f,e,c[h]),h++;for(i=0.125*d^0;i--;)this.A(f,e,c[h]),h++,this.A(f,e,c[h]),h++,this.A(f,e,c[h]),h++,this.A(f,e,c[h]),h++,this.A(f,e,c[h]),h++,this.A(f,e,c[h]),h++,this.A(f,e,c[h]),h++,this.A(f,e,c[h]),h++;c=new Oc;c.ba=a;this.dispatchEvent(c)};
cd.prototype.A=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),d=c.split(" ");if("vertex"==d[0]){var c=parseFloat(d[1]),f=parseFloat(d[2]),d=parseFloat(d[3]);a.add(c,f,d)}else"facet"==d[0]&&(c=parseFloat(d[2]),f=parseFloat(d[3]),d=parseFloat(d[4]),b.add(c,f,d),b.add(c,f,d),b.add(c,f,d))};B("X.parserSTL",cd);B("X.parserSTL.prototype.parse",cd.prototype.parse);function S(a,b,c){this.V=this.U=this.T=0;3==arguments.length?(this.T=Number(a),this.U=Number(b),this.V=Number(c)):"x"in a&&"y"in a&&"z"in a?(this.T=Number(a.x()),this.U=Number(a.y()),this.V=Number(a.b())):(this.T=Number(a[0]),this.U=Number(a[1]),this.V=Number(a[2]))}
S.prototype={d:function(){return new S(this.T,this.U,this.V)},Mc:function(){return new S(-this.T,-this.U,-this.V)},fb:function(a){return new S(this.T+a.x(),this.U+a.y(),this.V+a.b())},tb:function(a){return new S(this.T-a.x(),this.U-a.y(),this.V-a.b())},Ba:function(a){return new S(this.T*a,this.U*a,this.V*a)},te:function(a){return new S(this.T/a,this.U/a,this.V/a)},ab:function(a){return this.T*a.x()+this.U*a.y()+this.V*a.b()},Kd:function(a,b){return this.fb(a.tb(this).Ba(b))},length:function(){return Math.sqrt(this.ab(this))},
Ab:function(){return this.te(this.length())},Bc:function(a){return new S(this.U*a.b()-this.V*a.y(),this.V*a.x()-this.T*a.b(),this.T*a.y()-this.U*a.x())},x:s("T"),y:s("U"),b:s("V")};B("csgVector",S);B("csgVector.prototype.clone",S.prototype.d);B("csgVector.prototype.plus",S.prototype.fb);B("csgVector.prototype.minus",S.prototype.tb);B("csgVector.prototype.dividedBy",S.prototype.te);B("csgVector.prototype.times",S.prototype.Ba);B("csgVector.prototype.dot",S.prototype.ab);
B("csgVector.prototype.lerp",S.prototype.Kd);B("csgVector.prototype.length",S.prototype.length);B("csgVector.prototype.unit",S.prototype.Ab);B("csgVector.prototype.cross",S.prototype.Bc);B("csgVector.prototype.negated",S.prototype.Mc);B("csgVector.prototype.x",S.prototype.x);B("csgVector.prototype.y",S.prototype.y);B("csgVector.prototype.z",S.prototype.b);function dd(){this.Sc=n}
function ed(a,b,c){switch(typeof b){case "string":fd(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==q){c.push("null");break}if(ja(b)){var d=b.length;c.push("[");for(var f="",e=0;e<d;e++)c.push(f),f=b[e],ed(a,a.Sc?a.Sc.call(b,""+e,f):f,c),f=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),fd(e,c),c.push(":"),
ed(a,a.Sc?a.Sc.call(b,e,f):f,c),d=","));c.push("}");break;case "function":break;default:g(Error("Unknown type: "+typeof b))}}var gd={'"':'\\"',"\\":"\\\\","/":"\\/","\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},hd=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function fd(a,b){b.push('"',a.replace(hd,function(a){if(a in gd)return gd[a];var b=a.charCodeAt(0),f="\\u";16>b?f+="000":256>b?f+="00":4096>b&&(f+="0");return gd[a]=f+b.toString(16)}),'"')};function id(){Q.call(this);this._className="indexer";this.rd=[];this.L={}}C(id,Q);id.prototype.add=function(a){x(a)||g(Error("Invalid object."));var b;b=[];ed(new dd,a,b);b=b.join("");b in this.L||(this.L[b]=this.rd.length,this.rd.push(a));return this.L[b]};id.prototype.unique=s("rd");function jd(a,b){this.O=new S(a);this.z=new S(b)}jd.prototype={d:function(){return new jd(this.O.d(),this.z.d())},wa:function(){this.z=this.z.Mc()},Ee:function(a,b){return new jd(this.O.Kd(a.O,b),this.z.Kd(a.z,b))},Eg:s("O"),Nd:s("z")};B("csgVertex",jd);B("csgVertex.prototype.clone",jd.prototype.d);B("csgVertex.prototype.flip",jd.prototype.wa);B("csgVertex.prototype.interpolate",jd.prototype.Ee);B("csgVertex.prototype.pos",jd.prototype.Eg);B("csgVertex.prototype.normal",jd.prototype.Nd);function kd(a){Q.call(this);this._className="file";this.xf=a;this.c=p}C(kd,Q);kd.prototype.path=s("xf");function ld(){Q.call(this);this._className="colorTable";this.L=new Eb;var a=window["X.Counter"];a.Gd();this._id=a.value();this.aa=q}C(ld,Q);ld.prototype.add=function(a,b,c,d,f,e){(!z(a)||!z(c)||!z(d)||!z(f)||!z(e))&&g(Error("Invalid color table entry."));this.L.set(a,[b,c,d,f,e]);this.c=p};ld.prototype.id=s("_id");ld.prototype.file=s("aa");ld.prototype.Td=function(a){x(a)?(y(a)&&(a=new kd(a)),this.aa=a):this.aa=q};function md(a,b){this.z=a;this.Bb=b}md.prototype={d:function(){return new md(this.z.d(),this.Bb)},wa:function(){this.z=this.z.Mc();this.Bb=-this.Bb},lh:s("Bb"),Nd:s("z")};B("csgPlane.prototype.w",md.prototype.lh);B("csgPlane.prototype.normal",md.prototype.Nd);function nd(a,b){this.qa=a;this.ic=b;var c=a[0].O,d=a[2].O,d=a[1].O.tb(c).Bc(d.tb(c)).Ab();this.R=new md(d,d.ab(c))}
nd.prototype={d:function(){var a=this.qa.map(function(a){return a.d()});return new nd(a,this.ic)},wa:function(){this.qa.reverse().map(function(a){a.wa()});this.R.wa()},kh:s("qa"),Xg:s("ic"),ff:function(a,b,c,d,f){for(var e=0,h=[],i=0;i<this.qa.length;i++){var j=a.z.ab(this.qa[i].O)-a.Bb,j=-1.0E-5>j?2:1.0E-5<j?1:0,e=e|j;h.push(j)}switch(e){case 0:(0<a.z.ab(this.R.z)?b:c).push(this);break;case 1:d.push(this);break;case 2:f.push(this);break;case 3:b=[];c=[];for(i=0;i<this.qa.length;i++){var o=(i+1)%
this.qa.length,j=h[i],k=h[o],e=this.qa[i],o=this.qa[o];2!=j&&b.push(e);1!=j&&c.push(2!=j?e.d():e);3==(j|k)&&(j=(a.Bb-a.z.ab(e.O))/a.z.ab(o.O.tb(e.O)),j=e.Ee(o,j),b.push(j),c.push(j.d()))}3<=b.length&&d.push(new nd(b,this.ic));3<=c.length&&f.push(new nd(c,this.ic))}}};B("csgPolygon",nd);B("csgPolygon.prototype.clone",nd.prototype.d);B("csgPolygon.prototype.flip",nd.prototype.wa);B("csgPolygon.prototype.vertices",nd.prototype.kh);B("csgPolygon.prototype.shared",nd.prototype.Xg);function od(a){this.F=this.G=this.R=q;this.i=[];a&&this.pb(a)}
od.prototype={d:function(){var a=new od;a.Sg(this.R&&this.R.d());a.Pg(this.G&&this.G.d());a.Kg(this.F&&this.F.d());a.hc(this.i.map(function(a){return a.d()}));return a},C:function(){for(var a=0;a<this.i.length;a++)this.i[a].wa();this.R.wa();this.G&&this.G.C();this.F&&this.F.C();a=this.G;this.G=this.F;this.F=a},vd:function(a){if(!this.R)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].ff(this.R,b,c,b,c);this.G&&(b=this.G.vd(b));c=this.F?this.F.vd(c):[];return b.concat(c)},da:function(a){this.i=
a.vd(this.i);this.G&&this.G.da(a);this.F&&this.F.da(a)},Qa:function(){var a=this.i.slice();this.G&&(a=a.concat(this.G.Qa()));this.F&&(a=a.concat(this.F.Qa()));return a},pb:function(a){if(a.length){this.R||(this.R=a[0].R.d());for(var b=[],c=[],d=0;d<a.length;d++)a[d].ff(this.R,this.i,this.i,b,c);b.length&&(this.G||(this.G=new od),this.G.pb(b));c.length&&(this.F||(this.F=new od),this.F.pb(c))}},Sg:da("R"),Pg:da("G"),Kg:da("F"),Ze:s("i"),hc:da("i")};function U(){this.i=[]}function pd(a){var b=new U;b.hc(a);return b}
U.prototype={d:function(){var a=new U;a.hc(this.i.map(function(a){return a.d()}));return a},dh:s("i"),Xc:function(a){var b=new od(this.d().i),a=new od(a.d().i);b.da(a);a.da(b);a.C();a.da(b);a.C();b.pb(a.Qa());return pd(b.Qa())},pa:function(a){var b=new od(this.d().i),a=new od(a.d().i);b.C();b.da(a);a.da(b);a.C();a.da(b);a.C();b.pb(a.Qa());b.C();return pd(b.Qa())},Ic:function(a){var b=new od(this.d().i),a=new od(a.d().i);b.C();a.da(b);a.C();b.da(a);a.da(b);b.pb(a.Qa());b.C();return pd(b.Qa())},inverse:function(){var a=
this.d();a.i.map(function(a){a.wa()});return a},Ze:s("i"),hc:da("i")};B("CSG",U);B("CSG.fromPolygons",pd);B("CSG.prototype.toPolygons",U.prototype.dh);B("CSG.prototype.union",U.prototype.Xc);B("CSG.prototype.subtract",U.prototype.pa);B("CSG.prototype.intersect",U.prototype.Ic);B("CSG.prototype.inverse",U.prototype.inverse);B("CSG.prototype.polygons",U.prototype.Ze);B("CSG.prototype.setPolygons",U.prototype.hc);function V(a,b){this.x=ia(a)?a:0;this.y=ia(b)?b:0}V.prototype.d=function(){return new V(this.x,this.y)};V.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function qd(a,b){return new V(a.x-b.x,a.y-b.y)};function Hc(a,b){this.x=a;this.y=b}C(Hc,V);w=Hc.prototype;w.d=function(){return new Hc(this.x,this.y)};w.eb=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};w.scale=function(a){this.x*=a;this.y*=a;return this};w.C=function(){this.x=-this.x;this.y=-this.y;return this};w.normalize=function(){return this.scale(1/this.eb())};w.add=function(a){this.x+=a.x;this.y+=a.y;return this};w.pa=function(a){this.x-=a.x;this.y-=a.y;return this};
w.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};w.Tb=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function rd(a,b){this.width=a;this.height=b}function td(a,b){return a==b?p:!a||!b?r:a.width==b.width&&a.height==b.height}w=rd.prototype;w.d=function(){return new rd(this.width,this.height)};w.toString=function(){return"("+this.width+" x "+this.height+")"};w.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
w.scale=function(a){this.width*=a;this.height*=a;return this};function ud(a,b){if(a instanceof ud)this.w=a.kf();else{var c;if(c=ka(a))a:{for(var d=c=0;d<a.length;d++){if(!ka(a[d])||0<c&&a[d].length!=c){c=r;break a}for(var f=0;f<a[d].length;f++)if(!z(a[d][f])){c=r;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.w=vb(a):a instanceof rd?this.w=vd(a.height,a.width):z(a)&&z(b)&&0<a&&0<b?this.w=vd(a,b):g(Error("Invalid argument(s) for Matrix contructor"))}this.s=new rd(this.w[0].length,this.w.length)}
function wd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new ud(b)}function xd(a,b,c){for(var d=0;d<a.P().height;d++)for(var f=0;f<a.P().width;f++)b.call(c,a.w[d][f],d,f,a)}function yd(a,b){var c=new ud(a.P());xd(a,function(d,f,e){c.w[f][e]=b.call(n,d,f,e,a)});return c}function vd(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var f=0;f<b;f++)c[d][f]=0}return c}w=ud.prototype;
w.add=function(a){td(this.s,a.P())||g(Error("Matrix summation is only supported on arrays of equal size"));return yd(this,function(b,c,d){return b+a.w[c][d]})};w.Tb=function(a,b){if(this.s.width!=a.s.width||this.s.height!=a.s.height)return r;for(var c=b||0,d=0;d<this.s.height;d++)for(var f=0;f<this.s.width;f++)if(!(Math.abs(this.w[d][f]-a.w[d][f])<=(c||1.0E-6)))return r;return p};w.P=s("s");function zd(a,b,c){return!(0<=b&&b<a.s.height&&0<=c&&c<a.s.width)?q:a.w[b][c]}
function W(a,b,c,d){0<=b&&b<a.s.height&&0<=c&&c<a.s.width||g(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.s.height+","+a.s.width+")"));a.w[b][c]=d}w.multiply=function(a){if(a instanceof ud)return this.s.width!=a.P().height&&g(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),Ad(this,a);if(z(a))return Bd(this,a);g(Error("A matrix can only be multiplied by a number or another matrix."))};
w.pa=function(a){td(this.s,a.P())||g(Error("Matrix subtraction is only supported on arrays of equal size."));return yd(this,function(b,c,d){return b-a.w[c][d]})};w.kf=s("w");w.toString=function(){var a=0;xd(this,function(b){b=(""+b).length;b>a&&(a=b)});var b=[];pb(this.w,function(c){b.push("[ ");pb(c,function(c){c=""+c;b.push(Array(a-c.length+1).join(" ")+c+" ")});b.push("]\n")});return b.join("")};
function Ad(a,b){var c=new ud(a.s.height,b.P().width);xd(c,function(a,f,e){for(var h=a=0;h<this.s.width;h++)a+=zd(this,f,h)*zd(b,h,e);W(c,f,e,a)},a);return c}function Bd(a,b){return yd(a,function(a){return a*b})};function Y(a,b){ud.call(this,a,b);this._className="matrix"}C(Y,ud);function Cd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new Y(b)}w=Y.prototype;w.B=function(){var a=[],b=this.P();if(0==b.height||0==b.width)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(zd(this,c,d));return a};
w.translate=function(a){this.s.width!=this.s.height&&g(Error("Can not translate non-square matrix."));var b=this.P(),c=wd(b.height);a instanceof Hc&&3==b.height?(W(c,0,2,a.x),W(c,1,2,a.y)):a instanceof P&&4==b.height?(W(c,0,3,a.x),W(c,1,3,a.y),W(c,2,3,a.b)):g(Error("Translation failed."));return new Y(this.multiply(c))};
w.rotate=function(a,b){(4!=this.P().height||this.s.width!=this.s.height)&&g(Error("Only 4x4 matrices can be rotated."));(!x(b)||!(b instanceof P))&&g(Error("Invalid axis vector."));z(a)||g(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),f=Math.sin(a),e=wd(4);W(e,0,0,d+c.x*c.x*(1-d));W(e,0,1,c.x*c.y*(1-d)-c.b*f);W(e,0,2,c.x*c.b*(1-d)+c.y*f);W(e,1,0,c.y*c.x*(1-d)+c.b*f);W(e,1,1,d+c.y*c.y*(1-d));W(e,1,2,c.y*c.b*(1-d)-c.x*f);W(e,2,0,c.b*c.x*(1-d)-c.y*f);W(e,2,1,c.b*c.y*(1-d)+c.x*f);W(e,2,2,
d+c.b*c.b*(1-d));return new Y(this.multiply(e))};w.ha=function(a){var b=this.P(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof P&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):g(Error("Multiplication by vector failed."));a=this.multiply(new ud(c));return new P(parseFloat(zd(a,0,0)),parseFloat(zd(a,1,0)),parseFloat(zd(a,2,0)))};w.ah=function(a,b){var c=this.w[a];this.w[a]=this.w[b];this.w[b]=c};
w.$g=function(a,b){for(var c=this.P(),d=0,d=0;d<c.height;d++){var f=zd(this,d,a);f||(f=0);var e=zd(this,d,b);e||(e=0);W(this,d,a,e);W(this,d,b,f)}};B("X.matrix",Y);B("X.matrix.createIdentityMatrix",Cd);B("X.matrix.prototype.flatten",Y.prototype.B);B("X.matrix.prototype.translate",Y.prototype.translate);B("X.matrix.prototype.rotate",Y.prototype.rotate);B("X.matrix.prototype.multiplyByVector",Y.prototype.ha);B("X.matrix.prototype.swapRows",Y.prototype.ah);B("X.matrix.prototype.swapCols",Y.prototype.$g);function Dd(){Q.call(this);this._className="transform";this.f=Cd(4);this.ta=new Float32Array(this.f.B())}C(Dd,Q);w=Dd.prototype;w.Gg=function(a){(!z(a)||-360>a||360<a)&&g(Error("Invalid angle."));this.f=this.f.rotate(a*Math.PI/180,new P(0,1,0));this.ta=new Float32Array(this.f.B());this.c=p};w.Hg=function(a){(!z(a)||-360>a||360<a)&&g(Error("Invalid angle."));this.f=this.f.rotate(a*Math.PI/180,new P(1,0,0));this.ta=new Float32Array(this.f.B());this.c=p};
w.Ig=function(a){(!z(a)||-360>a||360<a)&&g(Error("Invalid angle."));this.f=this.f.rotate(a*Math.PI/180,new P(0,0,1));this.ta=new Float32Array(this.f.B());this.c=p};w.fh=function(a){z(a)||g(Error("Invalid distance."));this.f=this.f.translate(new P(a,0,0));this.ta=new Float32Array(this.f.B());this.c=p};w.gh=function(a){z(a)||g(Error("Invalid distance."));this.f=this.f.translate(new P(0,a,0));this.ta=new Float32Array(this.f.B());this.c=p};
w.hh=function(a){z(a)||g(Error("Invalid distance."));this.f=this.f.translate(new P(0,0,a));this.ta=new Float32Array(this.f.B());this.c=p};w.eg=s("f");w.cf=function(a){var b=Cd(4);x(a)&&a instanceof Y&&(b=a);this.f=b;this.ta=new Float32Array(this.f.B());this.c=p};function Ed(a,b,c){var d=zd(a.f,b,c);d||(d=0);W(a.f,b,c,-1*d);a.ta=new Float32Array(a.f.B());a.c=p}w.Qf=function(){Ed(this,0,0)};w.Rf=function(){Ed(this,1,1)};w.Sf=function(){Ed(this,2,2)};B("X.transform",Dd);
B("X.transform.prototype.rotateX",Dd.prototype.Gg);B("X.transform.prototype.rotateY",Dd.prototype.Hg);B("X.transform.prototype.rotateZ",Dd.prototype.Ig);B("X.transform.prototype.translateX",Dd.prototype.fh);B("X.transform.prototype.translateY",Dd.prototype.gh);B("X.transform.prototype.translateZ",Dd.prototype.hh);B("X.transform.prototype.matrix",Dd.prototype.eg);B("X.transform.prototype.setMatrix",Dd.prototype.cf);B("X.transform.prototype.flipX",Dd.prototype.Qf);B("X.transform.prototype.flipY",Dd.prototype.Rf);
B("X.transform.prototype.flipZ",Dd.prototype.Sf);function Fd(){Q.call(this);this._className="texture";var a=window["X.Counter"];a.Gd();this._id=a.value();this.Mb=this.$d=this.aa=q;this.sc=this.tc=0;this.c=p}C(Fd,Q);Fd.prototype.id=s("_id");Fd.prototype.file=s("aa");Fd.prototype.Td=function(a){x(a)?(y(a)&&(a=new kd(a)),this.aa=a):this.aa=q};Fd.prototype.Fd=s("$d");function L(a){Q.call(this);this._className="object";var b=window["X.Counter"];b.Gd();this._id=b.value();this._type=Gd;this.wc=new Dd;this._color=[1,1,1];this.k=new R;this.p=new R;this.$=new R;this.aa=this.Ya=this.K=q;this._opacity=1;this.ib=q;this._visible=p;this._lineWidth=this._pointSize=1;this._caption=q;this._magicMode=r;x(a)&&(this._type=a.type(),this.wc.cf(new Y(a.transform().f)),this._color=Array(a.color()),this.k=new R(a.k),this.p=new R(a.p),this.$=new R(a.$),this.K=a.K,this.Ya=a.Ya,a.file()&&
(this.aa=new kd((new String(a.file().path())).toString())),this._opacity=a.opacity(),this.ib=a.children(),this._visible=a.pf(),this._pointSize=a.Ye(),this._lineWidth=a.lineWidth(),a.caption()&&(this._caption=(new String(a.caption())).toString()),this._magicMode=a.Ke(),this.c=p);this.o=q;this.c=p}C(L,Q);var Gd="TRIANGLES",bd="LINES";w=L.prototype;w.id=s("_id");
function Hd(a){for(var b=a.k.count(),c=[],d=0,d=0;d<b;d+=3){var f=a.k.get(d),e=a.k.get(d+1),h=a.k.get(d+2),i=a.p.get(d),j=a.p.get(d+1),o=a.p.get(d+2),k=a._color;0<a.$.length()&&(k=a.$.get(d));var m=[];m.push(new jd(f,i));m.push(new jd(e,j));m.push(new jd(h,o));c.push(new nd(m,k))}return pd(c)}
function Id(a,b){(!x(b)||!(b instanceof U))&&g(Error("Invalid CSG object."));a.k.clear();a.p.clear();a.$.clear();var c=new id,d=[];qb(b.i,function(a){for(var b=[],h=a.ic,b=qb(a.qa,function(a){a.color=h;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.uf=qb(c.unique(),function(a){return[a.O.x(),a.O.y(),a.O.b()]});a.tf=qb(c.unique(),function(a){return[a.z.x(),a.z.y(),a.z.b()]});a.sf=qb(c.unique(),function(a){return!a.color?q:[a.color[0],a.color[1],a.color[2]]});qb(d,function(a){var b=
a[0],c=a[1],a=a[2],d=this.uf,j=this.tf,o=this.sf;this.k.add(d[b][0],d[b][1],d[b][2]);this.k.add(d[c][0],d[c][1],d[c][2]);this.k.add(d[a][0],d[a][1],d[a][2]);this.p.add(j[b][0],j[b][1],j[b][2]);this.p.add(j[c][0],j[c][1],j[c][2]);this.p.add(j[a][0],j[a][1],j[a][2]);o[b]&&this.$.add(o[b][0],o[b][1],o[b][2]);o[c]&&this.$.add(o[c][0],o[c][1],o[c][2]);o[a]&&this.$.add(o[a][0],o[a][1],o[a][2])}.bind(a));a.yb(Gd)}w.type=s("_type");w.yb=da("_type");w.transform=s("wc");w.Cg=s("k");w.hg=s("p");w.Hf=s("$");
w.color=s("_color");w.bh=s("K");w.Vc=function(a){if(x(a)){if(y(a)){var b=a,a=new Fd;a.Td(b)}a instanceof Fd||g(Error("Invalid texture."));this.K=a}else this.K=q};w.Gf=s("o");w.Ng=function(a){if(x(a)){if(y(a)){var b=a,a=new ld;a.Td(b)}a instanceof ld||g(Error("Invalid colorTable."));this.o=a}else this.o=q};
w.bf=function(a,b,c){(!z(a)&&0>a&&1<a||!z(b)&&0>b&&1<b||!z(c)&&0>c&&1<c)&&g(Error("Invalid color."));if(this.$b())for(var d=this.children(),f=d.length,e=0,e=0;e<f;e++)d[e].bf(a,b,c);this._color[0]=a;this._color[1]=b;this._color[2]=c;this.c=p};w.Xc=function(a){(!x(a)||!(a instanceof U)&&!(a instanceof L))&&g(Error("Invalid object."));var b=a;a instanceof L&&(b=Hd(b));a=new L;Id(a,Hd(this).Xc(b));return a};
w.pa=function(a){(!x(a)||!(a instanceof U)&&!(a instanceof L))&&g(Error("Invalid object."));var b=a;a instanceof L&&(b=Hd(b));a=new L;Id(a,Hd(this).pa(b));return a};w.Ic=function(a){(!x(a)||!(a instanceof U)&&!(a instanceof L))&&g(Error("Invalid object."));var b=a;a instanceof L&&(b=Hd(b));a=new L;Id(a,Hd(this).Ic(b));return a};w.inverse=function(a){(!x(a)||!(a instanceof U)&&!(a instanceof L))&&g(Error("Invalid object."));var b=a;a instanceof L&&(b=Hd(b));a=new L;Id(a,Hd(this).inverse(b));return a};
w.opacity=s("_opacity");w.caption=s("_caption");w.Lg=function(a){this._caption=a;this.c=p};w.r=function(a){if(this.$b())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].r(a);this._visible=a;this.c=p};w.pf=s("_visible");w.df=function(a){(!z(a)||1<a||0>a)&&g(Error("Invalid opacity."));if(this.$b())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].df(a);this._opacity=a;this.c=p};w.load=function(a){this.aa=x(a)?new kd(a):q};w.file=s("aa");w.Ta=function(){var a=new Oc;a.ba=this;this.dispatchEvent(a)};
w.children=function(){this.ib||(this.ib=[]);return this.ib};w.$b=function(){return!this.ib?r:0<this.ib.length};w.Qg=function(a){z(a)||g(Error("Invalid line width."));this._lineWidth=a;this.c=p};w.lineWidth=s("_lineWidth");w.Tg=function(a){z(a)||g(Error("Invalid point size."));this._pointSize=a;this.c=p};w.Ye=s("_pointSize");w.Ke=s("_magicMode");w.Rg=function(a){"boolean"!=typeof a&&g(Error("Invalid magicMode setting."));this._magicMode=a};
function Jd(a,b){(!x(a)||!x(b)||!(a instanceof L)||!(b instanceof L))&&g(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.opacity()?-1:1==b.opacity()?1:x(a.Cc)&&x(b.Cc)&&a.Cc>b.Cc?-1:1}B("X.object",L);B("X.object.prototype.id",L.prototype.id);B("X.object.prototype.type",L.prototype.type);B("X.object.prototype.transform",L.prototype.transform);B("X.object.prototype.points",L.prototype.Cg);B("X.object.prototype.normals",L.prototype.hg);B("X.object.prototype.texture",L.prototype.bh);
B("X.object.prototype.setTexture",L.prototype.Vc);B("X.object.prototype.colorTable",L.prototype.Gf);B("X.object.prototype.setColorTable",L.prototype.Ng);B("X.object.prototype.colors",L.prototype.Hf);B("X.object.prototype.color",L.prototype.color);B("X.object.prototype.setColor",L.prototype.bf);B("X.object.prototype.opacity",L.prototype.opacity);B("X.object.prototype.setOpacity",L.prototype.df);B("X.object.prototype.lineWidth",L.prototype.lineWidth);B("X.object.prototype.setLineWidth",L.prototype.Qg);
B("X.object.prototype.pointSize",L.prototype.Ye);B("X.object.prototype.setPointSize",L.prototype.Tg);B("X.object.prototype.load",L.prototype.load);B("X.object.prototype.file",L.prototype.file);B("X.object.prototype.caption",L.prototype.caption);B("X.object.prototype.visible",L.prototype.pf);B("X.object.prototype.setCaption",L.prototype.Lg);B("X.object.prototype.setVisible",L.prototype.r);B("X.object.prototype.magicMode",L.prototype.Ke);B("X.object.prototype.setMagicMode",L.prototype.Rg);
B("X.object.prototype.intersect",L.prototype.Ic);B("X.object.prototype.inverse",L.prototype.inverse);B("X.object.prototype.subtract",L.prototype.pa);B("X.object.prototype.union",L.prototype.Xc);B("X.object.prototype.children",L.prototype.children);function Kd(){Wc.call(this);this._className="parserVTK"}C(Kd,Wc);
Kd.prototype.parse=function(a,b){var c=a.k,d=a.p,f=b.split("\n"),e=f.length,h=new R,i=new R;this.H=[];this.ca=Gd;this.jd=this.Na=this.Da=this.Oa=r;for(var j=0,o=e%8;o--;)this.A(h,i,f[j]),j++;for(o=0.125*e^0;o--;)this.A(h,i,f[j]),j++,this.A(h,i,f[j]),j++,this.A(h,i,f[j]),j++,this.A(h,i,f[j]),j++,this.A(h,i,f[j]),j++,this.A(h,i,f[j]),j++,this.A(h,i,f[j]),j++,this.A(h,i,f[j]),j++;if(this.ca==Gd){f=i.length();j=e=this.H.length;do{var o=this.H[e-j],k=o.length,m;for(m=0;m<k;m++){var l=parseInt(o[m],10),
t=h.get(l);c.add(t[0],t[1],t[2]);l<f?(l=i.get(l),d.add(l[0],l[1],l[2])):(l=new P(t[0],t[1],t[2]),l.normalize(),d.add(l.x,l.y,l.b))}j--}while(0<j)}else if("TRIANGLE_STRIPS"==this.ca){f=i.length();j=e=this.H.length;do{o=this.H[e-j];k=o.length;for(m=0;m<k;m++)l=parseInt(o[m],10),t=h.get(l),c.add(t[0],t[1],t[2]),(0==m||m==k-1)&&c.add(t[0],t[1],t[2]),l<f?(l=i.get(l),d.add(l[0],l[1],l[2]),(0==m||m==k-1)&&d.add(l[0],l[1],l[2])):(l=new P(t[0],t[1],t[2]),l.normalize(),d.add(l.x,l.y,l.b),(0==m||m==k-1)&&d.add(l.x,
l.y,l.b));j--}while(0<j)}else if(this.ca==bd){f=i.length();j=e=this.H.length;do{o=this.H[e-j];k=o.length;for(m=0;m<k-1;m++){var u=parseInt(o[m],10),l=parseInt(o[m+1],10),v=h.get(u),t=h.get(l);c.add(v[0],v[1],v[2]);c.add(t[0],t[1],t[2]);u<f-1?(t=i.get(u),l=i.get(l),d.add(t[0],t[1],t[2]),d.add(l[0],l[1],l[2])):(l=new P(v[0],v[1],v[2]),l.normalize(),d.add(l.x,l.y,l.b),l=new P(t[0],t[1],t[2]),l.normalize(),d.add(l.x,l.y,l.b))}j--}while(0<j)}else if("POINTS"==this.ca){f=i.length();j=e=this.H.length;do{o=
this.H[e-j];k=o.length;for(m=0;m<k;m++)l=parseInt(o[m],10),t=h.get(l),c.add(t[0],t[1],t[2]),l<f?(l=i.get(l),d.add(l[0],l[1],l[2])):(l=new P(t[0],t[1],t[2]),l.normalize(),d.add(l.x,l.y,l.b));j--}while(0<j)}else if("POLYGONS"==this.ca){f=i.length();j=e=this.H.length;do{o=this.H[e-j];k=o.length;for(m=0;m<k;m++)l=parseInt(o[m],10),t=h.get(l),c.add(t[0],t[1],t[2]),l<f?(l=i.get(l),d.add(l[0],l[1],l[2])):(l=new P(t[0],t[1],t[2]),l.normalize(),d.add(l.x,l.y,l.b));j--}while(0<j)}a.yb(this.ca);c=new Oc;c.ba=
a;this.dispatchEvent(c)};
Kd.prototype.A=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),c=c.split(" "),d=c.length,f=c[0];if("POINTS"==f)this.Oa=p,this.Na=this.Da=r;else if("VERTICES"==f)this.Da=p,this.Na=this.Oa=r,a=parseInt(c[1],10),3<=a?this.ca=Gd:1==a?this.ca="POINTS":g(Error("VTK file not supported!")),this.H=[];else if("TRIANGLE_STRIPS"==f)this.Da=p,this.Na=this.Oa=r,this.ca="TRIANGLE_STRIPS",this.H=[];else if("LINES"==f)this.Da=p,this.Na=this.Oa=r,this.ca=bd,this.H=[];else if("POLYGONS"==f)this.Da=p,this.Na=this.Oa=
r,this.ca="POLYGONS",this.H=[];else if("POINT_DATA"==f)this.Na=p,this.Da=this.Oa=r;else if(this.Oa)if(1==d||isNaN(parseFloat(f)))this.Oa=r;else{if(3<=d){var f=parseFloat(c[0]),e=parseFloat(c[1]),h=parseFloat(c[2]);a.add(f,e,h)}6<=d&&(f=parseFloat(c[3]),e=parseFloat(c[4]),h=parseFloat(c[5]),a.add(f,e,h));9<=d&&(d=parseFloat(c[6]),f=parseFloat(c[7]),c=parseFloat(c[8]),a.add(d,f,c))}else this.Da?1==d||isNaN(parseFloat(f))?this.Da=r:this.H.push(c.slice(1)):this.Na&&("NORMALS"==f?this.jd=p:1==d||isNaN(parseFloat(f))?
this.jd=this.Na=r:this.jd&&(3<=d&&(f=parseFloat(c[0]),e=parseFloat(c[1]),h=parseFloat(c[2]),b.add(f,e,h)),6<=d&&(f=parseFloat(c[3]),e=parseFloat(c[4]),h=parseFloat(c[5]),b.add(f,e,h)),9<=d&&(d=parseFloat(c[6]),f=parseFloat(c[7]),c=parseFloat(c[8]),b.add(d,f,c))))};B("X.parserVTK",Kd);B("X.parserVTK.prototype.parse",Kd.prototype.parse);function Ld(){Wc.call(this);this._className="parserFSM"}C(Ld,Wc);
Ld.prototype.parse=function(a,b){var c=a.k,d=a.p,f=new R,e;e=3;var h=0,i;do i=this.t(b,e++),h++;while(200>h&&10!=i);e++;var j=$c(this,b,e);e+=4;h=$c(this,b,e);e+=4;i=[];for(var o=0,o=0;o<j;o++){var k=Xc(this,b,e);e+=4;var m=Xc(this,b,e);e+=4;var l=Xc(this,b,e);e+=4;i[o]=0;f.add(k,m,l)}j=[];o=[];for(k=0;k<h;k++){var t=$c(this,b,e);e+=4;l=$c(this,b,e);e+=4;m=$c(this,b,e);e+=4;i[t]+=1;i[l]+=1;i[m]+=1;j.push([t,l,m]);o.push(new P(0,0,0))}for(k=0;k<h;k++){var t=j[k][0],l=j[k][1],m=j[k][2],u=f.get(t);e=
f.get(l);var v=f.get(m),u=new P(u[0],u[1],u[2]),v=new P(v[0],v[1],v[2]);e=(new P(e[0],e[1],e[2])).d().pa(u);u=v.d().pa(u);e=Tc(e,u).normalize();o[t]=o[t].add(e);o[l]=o[l].add(e);o[m]=o[m].add(e)}for(k=0;k<h;k++)t=j[k][0],l=j[k][1],m=j[k][2],u=f.get(t),e=f.get(l),v=f.get(m),c.add(u[0],u[1],u[2]),c.add(e[0],e[1],e[2]),c.add(v[0],v[1],v[2]),t=o[t].scale(1/i[t]).normalize(),l=o[l].scale(1/i[l]).normalize(),m=o[m].scale(1/i[m]).normalize(),d.add(t.x,t.y,t.b),d.add(l.x,l.y,l.b),d.add(m.x,m.y,m.b);a.yb(Gd);
c=new Oc;c.ba=a;this.dispatchEvent(c)};B("X.parserFSM",Ld);B("X.parserFSM.prototype.parse",Ld.prototype.parse);function Md(a){function b(){O+=8;return Fc<fc.length?fc.charCodeAt(Fc++)&255:-1}function c(){var a;O++;a=M&1;M>>=1;0==M&&(M=b(),a=M&1,M=M>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=ba[b]>>8-a);return b}function f(a){N++;I[G++]=a;t.push(String.fromCharCode(a));32768==G&&(G=0)}function e(){this.Sa=this.Ra=0;this.Jc=q;this.He=-1}function h(){for(;;){if(Fb[sa]>=He)return-1;if(Ie[Fb[sa]]==sa)return Fb[sa]++;Fb[sa]++}}function i(){var a=Gb[Ka],b;u&&document.write("<br>len:"+sa+
" treepos:"+Ka);if(17==sa)return-1;Ka++;sa++;b=h();u&&document.write("<br>IsPat "+b);if(0<=b)a.Ra=b,u&&document.write("<br>b0 "+a.Ra);else if(a.Ra=32768,u&&document.write("<br>b0 "+a.Ra),i())return-1;b=h();if(0<=b)a.Sa=b,u&&document.write("<br>b1 "+a.Sa),a.Jc=q;else if(a.Sa=32768,u&&document.write("<br>b1 "+a.Sa),a.Jc=Gb[Ka],a.He=Ka,i())return-1;sa--;return 0}function j(a,b,c){u&&document.write("currentTree "+a+" numval "+b+" lengths "+c+" show 0");Gb=a;Ka=0;Ie=c;He=b;for(a=0;17>a;a++)Fb[a]=0;sa=
0;if(i())return u&&window.console.log("invalid huffman tree\n"),-1;if(u){document.write("<br>Tree: "+Gb.length);for(a=0;32>a;a++)document.write("Places["+a+"].b0="+Gb[a].Ra+"<br>"),document.write("Places["+a+"].b1="+Gb[a].Sa+"<br>")}return 0}function o(a){for(var b,d,e=0,f=a[e];;)if(b=c(),u&&document.write("b="+b),b){if(!(f.Sa&32768))return u&&document.write("ret1"),f.Sa;f=f.Jc;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Ra&32768))return u&&document.write("ret2"),f.Ra;e++;f=a[e]}}
function k(){var a,h,i,m;do{a=c();h=d(2);switch(h){case 0:u&&window.console.log("Stored\n");break;case 1:u&&window.console.log("Fixed Huffman codes\n");break;case 2:u&&window.console.log("Dynamic Huffman codes\n");break;case 3:u&&window.console.log("Reserved block type!!\n");break;default:u&&window.console.log("Unexpected value %d!\n",h)}if(0==h){var l;M=1;l=b();l|=b()<<8;h=b();h|=b()<<8;for((l^~h)&65535&&document.write("BlockLen checksum mismatch\n");l--;)h=b(),f(h)}else if(1==h)for(var k;;)if(k=
ba[d(7)]>>1,23<k?(k=k<<1|c(),199<k?(k-=128,k=k<<1|c()):(k-=48,143<k&&(k+=136))):k+=256,256>k)f(k);else if(256==k)break;else{k-=257;m=d(jb[k])+ha[k];k=ba[d(5)]>>3;8<ab[k]?(l=d(8),l|=d(ab[k]-8)<<8):l=d(ab[k]);l+=Gc[k];for(k=0;k<m;k++)h=I[G-l&32767],f(h)}else if(2==h){var t=Array(320);h=257+d(5);l=1+d(5);i=4+d(4);for(k=0;19>k;k++)t[k]=0;for(k=0;k<i;k++)t[sd[k]]=d(3);m=ca.length;for(i=0;i<m;i++)ca[i]=new e;if(j(ca,19,t)){G=0;return}if(u){document.write("<br>distanceTree");for(k=0;k<ca.length;k++)document.write("<br>"+
ca[k].Ra+" "+ca[k].Sa+" "+ca[k].Jc+" "+ca[k].He)}m=h+l;i=0;var v=-1;for(u&&document.write("<br>n="+m+" bits: "+O+"<br>");i<m;)if(v++,k=o(ca),u&&document.write("<br>"+v+" i:"+i+" decode: "+k+"    bits "+O+"<br>"),16>k)t[i++]=k;else if(16==k){var A;k=3+d(2);if(i+k>m){G=0;return}for(A=i?t[i-1]:0;k--;)t[i++]=A}else{k=17==k?3+d(3):11+d(7);if(i+k>m){G=0;return}for(;k--;)t[i++]=0}m=pa.length;for(i=0;i<m;i++)pa[i]=new e;if(j(pa,h,t)){G=0;return}m=pa.length;for(i=0;i<m;i++)ca[i]=new e;k=[];m=t.length;for(i=
h;i<m;i++)k[i-h]=t[i];if(j(ca,l,k)){G=0;return}for(u&&document.write("<br>literalTree");;)if(k=o(pa),256<=k){k-=256;if(0==k)break;k--;m=d(jb[k])+ha[k];k=o(ca);8<ab[k]?(l=d(8),l|=d(ab[k]-8)<<8):l=d(ab[k]);for(l+=Gc[k];m--;)h=I[G-l&32767],f(h)}else f(k)}}while(!a);G=0;M=1}function m(){u&&window.console.log("NEXTFILE");t=[];var a=[];A=r;a[0]=b();a[1]=b();u&&window.console.log("type: "+a[0]+" "+a[1]);120==a[0]&&218==a[1]&&(u&&window.console.log("GEONExT-GZIP"),k(),u&&window.console.log(t.join("")),D[E]=
Array(2),D[E][0]=t.join(""),D[E][1]="geonext.gxt",E++);31==a[0]&&139==a[1]&&(u&&window.console.log("GZIP"),l(),u&&window.console.log(t.join("")),D[E]=Array(2),D[E][0]=t.join(""),D[E][1]="file",E++);if(80==a[0]&&75==a[1]&&(A=p,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u&&window.console.log("ZIP-Version: "+a[1]+" "+a[0]/10+"."+a[0]%10);v=b();v|=b()<<8;u&&window.console.log("gpflags: "+v);a=b();a|=b()<<8;u&&window.console.log("method: "+a);b();b();b();b();var c=b(),c=c|b()<<8,c=c|b()<<16,
c=c|b()<<24,d=b(),d=d|b()<<8,d=d|b()<<16,d=d|b()<<24,e=b(),e=e|b()<<8,e=e|b()<<16,e=e|b()<<24;u&&window.console.log("local CRC: "+c+"\nlocal Size: "+e+"\nlocal CompSize: "+d);c=b();c|=b()<<8;d=b();d|=b()<<8;u&&window.console.log("filelen "+c);e=0;for(T=[];c--;){var f=b();"/"==f|":"==f?e=0:e<Z-1&&(T[e++]=String.fromCharCode(f))}u&&window.console.log("nameBuf: "+T);la||(la=T);for(e=0;e<d;)b(),e++;N=0;8==a&&(k(),u&&window.console.log(t.join("")),D[E]=Array(2),D[E][0]=t.join(""),D[E][1]=T.join(""),E++);
l()}}function l(){var a=[],c;v&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b(),u&&window.console.log("CRC:"));A&&m();a[0]=b();if(8!=a[0])u&&window.console.log("Unknown compression method!");else{v=b();u&&v&-32&&window.console.log("Unknown flags set!");b();b();b();b();b();b();if(v&4){a[0]=b();a[2]=b();sa=a[0]+256*a[1];u&&window.console.log("Extra field size: "+sa);for(a=0;a<sa;a++)b()}if(v&8){a=0;for(T=[];c=b();){if("7"==
c||":"==c)a=0;a<Z-1&&(T[a++]=c)}u&&window.console.log("original file name: "+T)}if(v&16)for(;b(););v&2&&(b(),b());k();b();b();b();b();b();b();b();b();A&&m()}}var t=[],u=r,v,E=0,D=[],I=Array(32768),G=0,A=r,N,ba=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,
74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,
251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],ha=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],jb=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],Gc=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ab=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],sd=[16,17,18,0,8,7,9,6,10,5,
11,4,12,3,13,2,14,1,15],fc=a,Fc=0,M=1,O=0,Z=256,T=[],la,pa=Array(288),ca=Array(32),Ka=0,Gb=q,sa=0,Fb=Array(17);Fb[0]=0;var Ie,He;Md.prototype.ih=function(){u&&window.console.log(fc);m();return D}};function Nd(){Wc.call(this);this._className="parserNRRD"}C(Nd,Wc);
Nd.prototype.parse=function(a,b){var c=0,d=b.match(/^([\s\S]*?)\r?\n\r?\n/),c=d[0].length,f,e,h,i,j,o,d=d[1].split(/\r?\n/);for(j=0,o=d.length;j<o;j++)if(f=d[j],f.match(/NRRD\d+/))this.ag=p;else if(!f.match(/^#/)&&(i=f.match(/(.*):(.*)/)))e=i[1].trim(),f=i[2].trim(),(h=this.Pf[e])?h.call(this,f):this[e]=f;this.ag||g(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding&&g(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Z&&(this.Z=[new P(1,0,0),new P(0,
1,0),new P(0,0,1)],this.Wd)){d=[];for(i=0;2>=i;i++)d.push(!isNaN(this.Wd[i])?this.Z[i].scale(this.Wd[i]):n)}i=0;i="gzip"==this.encoding||"gz"==this.encoding?(new Md(b.substr(c))).ih()[0][0]:b.substr(c);j=this.hb[0]*this.hb[1]*this.hb[2];c=Array(j);d=-Infinity;o=Infinity;for(f=0;f<j;f++)e=this.Pc(i,0+f*this.Oc),c[f]=e,d=Math.max(d,e),o=Math.min(o,e);a.ja=[this.hb[0],this.hb[1],this.hb[2]];a.J=[(new P(this.Z[0][0],this.Z[0][1],this.Z[0][2])).eb(),(new P(this.Z[1][0],this.Z[1][1],this.Z[1][2])).eb(),
(new P(this.Z[2][0],this.Z[2][1],this.Z[2][2])).eb()];a.Nb=[o,d];a.jf(o,d);a.va();o=this.hb;i=d;d=o[2];j=o[1];o=o[0];f=a.I!=q;h=j*o;e=Array(d);for(var k=0;k<d;k++){e[k]=Array(j);for(var m=0;m<j;m++)e[k][m]=Array(o)}for(var l=0,k=k=0;k<d;k++){for(var t=c.slice(k*h,(k+1)*h),m=new Uint8Array(4*h),u=0,v=0,E=0,u=0;u<j;u++)for(v=0;v<o;v++){var l=t[E],D=0,I=0,G=0,A=0;a.o?((A=a.o.L.get(Math.floor(l)))||(A=a.o.L.get(a.o.L.N()-1)),D=255*A[1],I=255*A[2],G=255*A[3],A=255*A[4]):(D=I=G=255*(l/i),A=255);var N=4*
E;m[N]=D;m[++N]=I;m[++N]=G;m[++N]=A;e[k][u][v]=l;E++}u=l=new Fd;u.Mb=m;u.c=p;m=l;m.tc=o;m.c=p;m=l;m.sc=j;m.c=p;t=a.qd.children()[k];t.Vc(l);f&&(t.I=a.I.qd.children()[k].K)}for(u=0;u<j;u++){m=new Uint8Array(4*d*o);for(k=E=0;k<d;k++)for(v=0;v<o;v++)l=e[k][u][v],a.o?((A=a.o.L.get(Math.floor(l)))||(A=a.o.L.get(a.o.L.N()-1)),D=255*A[1],I=255*A[2],G=255*A[3],A=255*A[4]):(D=I=G=255*(l/i),A=255),N=4*E,m[N]=D,m[++N]=I,m[++N]=G,m[++N]=A,E++;c=l=new Fd;c.Mb=m;c.c=p;c=l;c.tc=o;c.c=p;c=l;c.sc=d;c.c=p;t=a.pd.children()[u];
t.Vc(l);f&&(t.I=a.I.pd.children()[u].K)}for(v=0;v<o;v++){m=new Uint8Array(4*d*j);for(k=E=0;k<d;k++)for(u=0;u<j;u++)l=e[k][u][v],a.o?((A=a.o.L.get(Math.floor(l)))||(A=a.o.L.get(a.o.L.N()-1)),D=255*A[1],I=255*A[2],G=255*A[3],A=255*A[4]):(D=I=G=255*(l/i),A=255),N=4*E,m[N]=D,m[++N]=I,m[++N]=G,m[++N]=A,E++;c=l=new Fd;c.Mb=m;c.c=p;c=l;c.tc=j;c.c=p;c=l;c.sc=d;c.c=p;t=a.od.children()[v];t.Vc(l);f&&(t.I=a.I.od.children()[v].K)}c=new Oc;c.ba=a;this.dispatchEvent(c)};
Nd.prototype.Pf={type:function(a){switch(a){case "unsigned char":case "uint8":this.Pc=this.t;this.Oc=1;break;case "signed char":case "int8":this.Pc=this.Bg;this.Oc=1;break;case "short":case "signed short":case "unsigned short":case "short int":case "int16":this.Pc=this.Qc;this.Oc=2;break;case "int":case "int32":break;case "float":this.Pc=this.ec;this.Oc=4;break;default:g(Error("Only short/int/int8/float data is allowed. Found "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=
a},dimension:function(a){return parseInt(a,10)},sizes:function(a){var b,c,d,f;d=a.split(/\s+/);f=[];for(b=0,c=d.length;b<c;b++)a=d[b],f.push(parseInt(a,10));return this.hb=f},"space directions":function(a){var b,c,d;c=a.match(/\(.*?\)/g);return this.Z=function(){var a,e,h;h=[];for(a=0,e=c.length;a<e;a++)d=c[a],h.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return h}()},spacings:function(a){var b;b=a.split(/\s+/);var c,
d,f;f=[];for(c=0,d=b.length;c<d;c++)a=b[c],f.push(parseFloat(a));return this.Wd=f}};B("X.parserNRRD",Nd);B("X.parserNRRD.prototype.parse",Nd.prototype.parse);function Od(){Wc.call(this);this._className="parserLUT"}C(Od,Wc);Od.prototype.parse=function(a,b,c){var b=b.split("\n"),d=b.length,f;for(f=0;f<d;++f){var e=b[f],e=e.replace(/^\s+|\s+$/g,"");"#"!=e[0]&&(e=e.split(" "),e=e.filter(function(a){return""!=a}),6==e.length&&(e[2]=parseInt(e[2],10)/255,e[3]=parseInt(e[3],10)/255,e[4]=parseInt(e[4],10)/255,e[5]=parseInt(e[5],10)/255,c.add(parseInt(e[0],10),e[1],e[2],e[3],e[4],e[5],10)))}c=new Oc;c.ba=a;this.dispatchEvent(c)};B("X.parserLUT",Od);
B("X.parserLUT.prototype.parse",Od.prototype.parse);function Pd(){Q.call(this);this._className="loader";this.nb=q;this.Lb=0}C(Pd,Q);function Qd(a){x(a.nb)||(a.nb=new Eb);return a.nb}function Rd(a){return!x(a.nb)?p:!a.nb.wd(r)}w=Pd.prototype;w.dg=function(a){Sd(this,1.7);setTimeout(function(){Vc(a.K.file());a.Ta();Qd(this).set(a.id(),p)}.bind(this),100)};function Sd(a,b){a.Lb+=b/Qd(a).N()/3;1<a.Lb&&(a.Lb=1);var c=new Pc;c.ie=a.Lb;a.dispatchEvent(c)}w.Kc=function(){g(Error("Could not get the file."))};
w.bg=function(a,b){setTimeout(function(){var c=new Od;lc(c,rc,this.Ag.bind(this));c.parse(b,a.response,b.o)}.bind(this),100)};
w.cg=function(a,b){Sd(this,1);setTimeout(function(){var c=b.file().path().split(".").pop().toLowerCase();"stl"==c?(c=new cd,lc(c,rc,this.dc.bind(this)),c.parse(b,a.response)):"vtk"==c?(c=new Kd,lc(c,rc,this.dc.bind(this)),c.parse(b,a.response)):"trk"==c?(c=new ad,lc(c,rc,this.dc.bind(this)),c.parse(b,a.response)):"fsm"==c?(c=new Ld,lc(c,rc,this.dc.bind(this)),c.parse(b,a.response)):"nrrd"==c&&(c=new Nd,lc(c,rc,this.dc.bind(this)),c.parse(b,a.response))}.bind(this),100)};
w.dc=function(a){Sd(this,1);setTimeout(function(){var b=a.ba;Vc(b.file());b.Ta();Qd(this).set(b.id(),p)}.bind(this),100)};w.Ag=function(a){setTimeout(function(){var b=a.ba;Vc(b.o.file());b.Ta();Qd(this).set(b.o.id(),p)}.bind(this),100)};function Td(a,b,c,d,f){(!x(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid center."));(!x(b)||!(b instanceof Array)||3!=b.length)&&g(Error("Invalid front direction."));(!x(c)||!(c instanceof Array)||3!=c.length)&&g(Error("Invalid up direction."));z(d)||g(Error("Invalid width."));z(f)||g(Error("Invalid height."));L.call(this);this._className="slice";this.j=a;this.$c=b;this.Za=c;this.ob=d;this.Wa=f;this.Ya=[0,1,0,0,1,1,1,1,1,0,0,0];this.I=this.Pa=q;this.va()}C(Td,L);
Td.prototype.va=function(){this.k.clear();var a=new P(this.$c[0],this.$c[1],this.$c[2]),b=new P(this.Za[0],this.Za[1],this.Za[2]),c=Tc(b,a),d=new P(this.j[0],this.j[1],this.j[2]),f=new P(1,1,1);1==a.x?(f=new P(this.j[0],this.Wa/2,this.ob/2),this.Ya=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(f=new P(this.ob/2,this.j[1],this.Wa/2),this.Ya=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(f=new P(this.ob/2,this.Wa/2,this.j[2]));var e=Sc(c.d().C(),b.d().C()),e=new P(e.x*f.x,e.y*f.y,e.b*f.b);e.add(d);var h=Sc(c.d().C(),b),
h=new P(h.x*f.x,h.y*f.y,h.b*f.b);h.add(d);var i=Sc(c,b.d().C()),i=new P(i.x*f.x,i.y*f.y,i.b*f.b);i.add(d);var j=i,b=Sc(c,b),b=new P(b.x*f.x,b.y*f.y,b.b*f.b);b.add(d);d=h;this.k.add(e.x,e.y,e.b);this.k.add(h.x,h.y,h.b);this.k.add(i.x,i.y,i.b);this.k.add(j.x,j.y,j.b);this.k.add(b.x,b.y,b.b);this.k.add(d.x,d.y,d.b);this.p.add(a.x,a.y,a.b);this.p.add(a.x,a.y,a.b);this.p.add(a.x,a.y,a.b);this.p.add(a.x,a.y,a.b);this.p.add(a.x,a.y,a.b);this.p.add(a.x,a.y,a.b)};Td.prototype.Ie=s("I");B("X.slice",Td);function Ud(){L.call(this);this._className="volume";this.j=[0,0,0];this.ja=[10,10,10];this.J=[1,1,1];this.dd=this._indexZ=this.cd=this._indexY=this.bd=this._indexX=0;this.od=new L;this.pd=new L;this.qd=new L;this._lowerThreshold=0;this._upperThreshold=1E3;this.Nb=[0,1E3];this.je=this._volumeRendering=r;this.Rb=0;this.I=q}C(Ud,L);w=Ud.prototype;
w.va=function(){this.children().length=0;this.children().push(this.od);this.children().push(this.pd);this.children().push(this.qd);for(var a=0,a=0;3>a;a++){for(var b=(this.ja[a]-1)/2,c=b,d=0,d=0;d<this.ja[a];d++){var f=-b*this.J[a]+d*this.J[a],e=[[this.j[0]+f,this.j[1],this.j[2]],[this.j[0],this.j[1]+f,this.j[2]],[this.j[0],this.j[1],this.j[2]+f]],f=this.children()[a].children(),h=0,i=0;0==a?(h=this.ja[2]*this.J[2]-this.J[2],i=this.ja[1]*this.J[1]-this.J[1]):1==a?(h=this.ja[0]*this.J[0]-this.J[0],
i=this.ja[2]*this.J[2]-this.J[2]):2==a&&(h=this.ja[0]*this.J[0]-this.J[0],i=this.ja[1]*this.J[1]-this.J[1]);e=new Td(e[a],[[1,0,0],[0,1,0],[0,0,1]][a],[[0,1,0],[0,0,-1],[0,1,0]][a],h,i);e.Pa=this;e.r(d==c);f.push(e)}0==a?this.bd=this._indexX=c:1==a?this.cd=this._indexY=c:2==a&&(this.dd=this._indexZ=c)}this.c=p};
w.Ta=function(){if(0<this.children().length)if(this._volumeRendering!=this.je&&(this.c=p,this.je=this._volumeRendering),this._volumeRendering)Vd(this,this.Rb);else{if(this.c){var a=this.children()[this.Rb];a.r(r)}for(var b=0,b=0;3>b;b++){var a=this.children()[b],c=0,d=0;0==b?(c=this._indexX,d=this.bd,this.bd=this._indexX):1==b?(c=this._indexY,d=this.cd,this.cd=this._indexY):2==b&&(c=this._indexZ,d=this.dd,this.dd=this._indexZ);a.children()[parseInt(d,10)].r(r);a.children()[parseInt(c,10)].r(p)}}Ud.D.Ta.call(this)};
w.Mf=s("ja");w.Jg=s("Nb");w.jf=function(a,b){(!x(a)||!z(a)||!x(b)||!z(b)||a>b||a<this.Nb[0]||b>this.Nb[1])&&g(Error("Invalid threshold range."));this._lowerThreshold=a;this._upperThreshold=b};w.Wg=aa();w.r=da("_visible");w.Mg=function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid center."));this.j=a};
function Vd(a,b){if(!(!a.c&&!a._volumeRendering||!a.c&&b==a.Rb)){a.children()[0].children()[parseInt(a._indexX,10)].r(r);a.children()[1].children()[parseInt(a._indexY,10)].r(r);a.children()[2].children()[parseInt(a._indexZ,10)].r(r);var c=a.children()[a.Rb];c.r(r);c=a.children()[b];c.r(p);a.Rb=b}}w.Ie=function(){this.I||(this.I=new Wd(this));return this.I};B("X.volume",Ud);B("X.volume.prototype.dimensions",Ud.prototype.Mf);B("X.volume.prototype.scalarRange",Ud.prototype.Jg);
B("X.volume.prototype.setVisible",Ud.prototype.r);B("X.volume.prototype.setCenter",Ud.prototype.Mg);B("X.volume.prototype.setVolumeRendering",Ud.prototype.Wg);B("X.volume.prototype.threshold",Ud.prototype.jf);B("X.volume.prototype.modified",Ud.prototype.Ta);B("X.volume.prototype.labelMap",Ud.prototype.Ie);function Wd(a){Ud.call(this);this._className="labelMap";this.Pa=a}C(Wd,Ud);Wd.prototype.Ta=function(){var a=new Oc;a.ba=this;this.dispatchEvent(a);this.Pa.Ta()};B("X.labelMap",Wd);function Xd(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Xd.prototype.d=function(){return new Xd(this.top,this.right,this.bottom,this.left)};Xd.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};Xd.prototype.contains=function(a){return!this||!a?r:a instanceof Xd?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function Yd(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}w=Yd.prototype;w.d=function(){return new Yd(this.left,this.top,this.width,this.height)};w.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};
w.Fe=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,p}return r};w.contains=function(a){return a instanceof Yd?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
w.P=function(){return new rd(this.width,this.height)};var Zd;function $d(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=wb(arguments,1),f;f=c;for(var e=0,h=0;h<d.length;h++)0<=ob(f,d[h])||(f.push(d[h]),e++);f=e==d.length;a.className=c.join(" ");return f};var ae=!F||gb(9);!Ra&&!F||F&&gb(9)||Ra&&eb("1.9.1");F&&eb("9");function be(a){return a?new ce(de(a)):Zd||(Zd=new ce)}function ee(a){return y(a)?document.getElementById(a):a}function fe(a,b){hb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in ge?a.setAttribute(ge[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var ge={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function he(a,b,c){return ie(document,arguments)}
function ie(a,b){var c=b[0],d=b[1];if(!ae&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',ya(d.name),'"');if(d.type){c.push(' type="',ya(d.type),'"');var f={};mb(f,d);d=f;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(y(d)?c.className=d:ja(d)?$d.apply(q,[c].concat(d)):fe(c,d));2<b.length&&je(a,c,b);return c}
function je(a,b,c){function d(c){c&&b.appendChild(y(c)?a.createTextNode(c):c)}for(var f=2;f<c.length;f++){var e=c[f];ka(e)&&!(na(e)&&0<e.nodeType)?pb(ke(e)?vb(e):e,d):d(e)}}function le(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function me(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function ne(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function de(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ke(a){if(a&&"number"==typeof a.length){if(na(a))return"function"==typeof a.item||"string"==typeof a.item;if(ma(a))return"function"==typeof a.item}return r}function ce(a){this.v=a||ea.document||document}w=ce.prototype;
w.Ec=be;w.e=function(a){return y(a)?this.v.getElementById(a):a};w.rb=function(a,b,c){return ie(this.v,arguments)};w.createElement=function(a){return this.v.createElement(a)};w.createTextNode=function(a){return this.v.createTextNode(a)};function oe(a){return"CSS1Compat"==a.v.compatMode}function pe(a){var b=a.v,a=!H&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new V(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}w.appendChild=function(a,b){a.appendChild(b)};
w.contains=ne;function qe(a,b){var c=de(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,q))?c[b]||c.getPropertyValue(b):""}function re(a,b){return a.currentStyle?a.currentStyle[b]:q}function se(a,b){return qe(a,b)||re(a,b)||a.style&&a.style[b]}function te(a){a=a?9==a.nodeType?a:de(a):document;return F&&!gb(9)&&!oe(be(a))?a.body:a.documentElement}
function ue(a){var b=a.getBoundingClientRect();F&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ve(a){if(F&&!gb(8))return a.offsetParent;for(var b=de(a),c=se(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=se(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return q}
function we(a){for(var b=new Xd(0,Infinity,Infinity,0),c=be(a),d=c.v.body,f=c.v.documentElement,e=!H&&"CSS1Compat"==c.v.compatMode?c.v.documentElement:c.v.body;a=ve(a);)if((!F||0!=a.clientWidth)&&(!H||0!=a.clientHeight||a!=d)&&a!=d&&a!=f&&"visible"!=se(a,"overflow")){var h=xe(a),i;i=a;if(Ra&&!eb("1.9")){var j=parseFloat(qe(i,"borderLeftWidth"));if(ye(i))var o=i.offsetWidth-i.clientWidth-j-parseFloat(qe(i,"borderRightWidth")),j=j+o;i=new V(j,parseFloat(qe(i,"borderTopWidth")))}else i=new V(i.clientLeft,
i.clientTop);h.x+=i.x;h.y+=i.y;b.top=Math.max(b.top,h.y);b.right=Math.min(b.right,h.x+a.clientWidth);b.bottom=Math.min(b.bottom,h.y+a.clientHeight);b.left=Math.max(b.left,h.x)}d=e.scrollLeft;e=e.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,e);c=c.v.parentWindow||c.v.defaultView||window;f=c.document;H&&!eb("500")&&!Sa?("undefined"==typeof c.innerHeight&&(c=window),f=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<f&&(f-=15),c=new rd(c.innerWidth,f)):(c="CSS1Compat"==
f.compatMode?f.documentElement:f.body,c=new rd(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,e+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:q}
function xe(a){var b,c=de(a),d=se(a,"position"),f=Ra&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),e=new V(0,0),h=te(c);if(a==h)return e;if(a.getBoundingClientRect)b=ue(a),a=pe(be(c)),e.x=b.left+a.x,e.y=b.top+a.y;else if(c.getBoxObjectFor&&!f)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(h),e.x=b.screenX-a.screenX,e.y=b.screenY-a.screenY;else{b=a;do{e.x+=b.offsetLeft;e.y+=b.offsetTop;b!=a&&(e.x+=b.clientLeft||0,e.y+=b.clientTop||0);
if(H&&"fixed"==se(b,"position")){e.x+=c.body.scrollLeft;e.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Qa||H&&"absolute"==d)e.y-=c.body.offsetTop;for(b=a;(b=ve(b))&&b!=c.body&&b!=h;)if(e.x-=b.scrollLeft,!Qa||"TR"!=b.tagName)e.y-=b.scrollTop}return e}function ze(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function Ae(a){if("none"!=se(a,"display"))return Be(a);var b=a.style,c=b.display,d=b.visibility,f=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=Be(a);b.display=c;b.position=f;b.visibility=d;return a}function Be(a){var b=a.offsetWidth,c=a.offsetHeight,d=H&&!b&&!c;return(!ia(b)||d)&&a.getBoundingClientRect?(a=ue(a),new rd(a.right-a.left,a.bottom-a.top)):new rd(b,c)}function Ce(a,b){a.style.display=b?"":"none"}function ye(a){return"rtl"==se(a,"direction")}
function De(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var f=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return f}var Ee={thin:2,medium:4,thick:6};function Fe(a,b){if("none"==re(a,b+"Style"))return 0;var c=re(a,b+"Width");return c in Ee?Ee[c]:De(a,c)};function Ge(a,b,c,d,f,e,h,i){var j,o=c.offsetParent;if(o){var k="HTML"==o.tagName||"BODY"==o.tagName;if(!k||"static"!=se(o,"position"))j=xe(o),k||(j=qd(j,new V(o.scrollLeft,o.scrollTop)))}o=xe(a);k=Ae(a);o=new Yd(o.x,o.y,k.width,k.height);(k=we(a))&&o.Fe(new Yd(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=be(a),m=be(c);if(k.v!=m.v){var l=k.v.body,m=m.v.parentWindow||m.v.defaultView,t=new V(0,0),u=de(l)?de(l).parentWindow||de(l).defaultView:window,v=l;do{var E;if(u==m)E=xe(v);else{var D=v;E=
new V;if(1==D.nodeType)if(D.getBoundingClientRect)D=ue(D),E.x=D.left,E.y=D.top;else{var I=pe(be(D)),D=xe(D);E.x=D.x-I.x;E.y=D.y-I.y}else{var I=ma(D.Tf),G=D;D.targetTouches?G=D.targetTouches[0]:I&&D.ma.targetTouches&&(G=D.ma.targetTouches[0]);E.x=G.clientX;E.y=G.clientY}}t.x+=E.x;t.y+=E.y}while(u&&u!=m&&(v=u.frameElement)&&(u=u.parent));l=qd(t,xe(l));F&&!oe(k)&&(l=qd(l,pe(k)));o.left+=l.x;o.top+=l.y}a=(b&4&&ye(a)?b^2:b)&-5;b=new V(a&2?o.left+o.width:o.left,a&1?o.top+o.height:o.top);j&&(b=qd(b,j));
f&&(b.x+=(a&2?-1:1)*f.x,b.y+=(a&1?-1:1)*f.y);var A;if(h&&(A=we(c))&&j)A.top-=j.y,A.right-=j.x,A.bottom-=j.y,A.left-=j.x;return Je(b,c,d,e,A,h,i)}
function Je(a,b,c,d,f,e,h){var a=a.d(),i=0,j=(c&4&&ye(b)?c^2:c)&-5,c=Ae(b),h=h?h.d():c.d();if(d||0!=j)j&2?a.x-=h.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=h.height+(d?d.bottom:0):d&&(a.y+=d.top);if(e){if(f){i=a;d=0;if(65==(e&65)&&(i.x<f.left||i.x>=f.right))e&=-2;if(132==(e&132)&&(i.y<f.top||i.y>=f.bottom))e&=-5;i.x<f.left&&e&1&&(i.x=f.left,d|=1);i.x<f.left&&i.x+h.width>f.right&&e&16&&(h.width=Math.max(h.width-(i.x+h.width-f.right),0),d|=4);i.x+h.width>f.right&&e&1&&(i.x=Math.max(f.right-h.width,
f.left),d|=1);e&2&&(d|=(i.x<f.left?16:0)|(i.x+h.width>f.right?32:0));i.y<f.top&&e&4&&(i.y=f.top,d|=2);i.y>=f.top&&i.y+h.height>f.bottom&&e&32&&(h.height=Math.max(h.height-(i.y+h.height-f.bottom),0),d|=8);i.y+h.height>f.bottom&&e&4&&(i.y=Math.max(f.bottom-h.height,f.top),d|=2);e&8&&(d|=(i.y<f.top?64:0)|(i.y+h.height>f.bottom?128:0));i=d}else i=256;if(i&496)return i}e=a;f=Ra&&(Ja||Va)&&eb("1.9");e instanceof V?(a=e.x,e=e.y):(a=e,e=n);b.style.left=ze(a,f);b.style.top=ze(e,f);td(c,h)||(a=oe(be(de(b))),
F&&(!a||!eb("8"))?(c=b.style,a?(F?(a=De(b,re(b,"paddingLeft")),f=De(b,re(b,"paddingRight")),e=De(b,re(b,"paddingTop")),d=De(b,re(b,"paddingBottom")),a=new Xd(e,f,d,a)):(a=qe(b,"paddingLeft"),f=qe(b,"paddingRight"),e=qe(b,"paddingTop"),d=qe(b,"paddingBottom"),a=new Xd(parseFloat(e),parseFloat(f),parseFloat(d),parseFloat(a))),F?(f=Fe(b,"borderLeft"),e=Fe(b,"borderRight"),d=Fe(b,"borderTop"),b=Fe(b,"borderBottom"),b=new Xd(d,e,b,f)):(f=qe(b,"borderLeftWidth"),e=qe(b,"borderRightWidth"),d=qe(b,"borderTopWidth"),
b=qe(b,"borderBottomWidth"),b=new Xd(parseFloat(d),parseFloat(e),parseFloat(b),parseFloat(f))),c.pixelWidth=h.width-b.left-a.left-a.right-b.right,c.pixelHeight=h.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=h.width,c.pixelHeight=h.height)):(b=b.style,Ra?b.MozBoxSizing="border-box":H?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(h.width,0)+"px",b.height=Math.max(h.height,0)+"px"));return i};var Ke=ea.window;function Le(a,b,c){ma(a)?c&&(a=va(a,c)):a&&"function"==typeof a.handleEvent?a=va(a.handleEvent,a):g(Error("Invalid listener argument"));return 2147483647<b?-1:Ke.setTimeout(a,b||0)};function Me(){}Me.prototype.oa=aa();function Ne(a,b){this.element=a;this.oe=b}C(Ne,Me);Ne.prototype.oa=function(a,b,c){Ge(this.element,this.oe,a,b,n,c)};function Oe(a){this.ga=a;this.n=[]}C(Oe,Nb);var Pe=[];function Qe(a,b,c,d,f){ja(c)||(Pe[0]=c,c=Pe);for(var e=0;e<c.length;e++)a.n.push(J(b,c[e],d||a,f||r,a.ga||a))}Oe.prototype.Rc=function(){pb(this.n,nc);this.n.length=0};Oe.prototype.u=function(){Oe.D.u.call(this);this.Rc()};Oe.prototype.handleEvent=function(){g(Error("EventHandler.handleEvent not implemented"))};function Re(a,b){this.ga=new Oe(this);this.Sd(a||q);b&&this.yb(b)}C(Re,Uc);w=Re.prototype;w.h=q;w.Ef=p;w.ke=q;w.Q=r;w.Yg=r;w.Jd=-1;w.Wf=r;w.Of=p;w.zb="toggle_display";w.yb=da("zb");w.e=s("h");w.Sd=function(a){this.Q&&g(Error("Can not change this state of the popup while showing."));this.h=a};
w.r=function(a){this.jc&&this.jc.stop();this.ac&&this.ac.stop();if(a){if(!this.Q&&this.Od()){this.h||g(Error("Caller must call setElement before trying to show the popup"));this.oa();a=de(this.h);this.Wf&&Qe(this.ga,a,"keydown",this.ig,p);if(this.Ef)if(Qe(this.ga,a,"mousedown",this.Re,p),F){var b;try{b=a.activeElement}catch(c){}for(;b&&"IFRAME"==b.nodeName;){try{var d=b.contentDocument||b.contentWindow.document}catch(f){break}a=d;b=a.activeElement}Qe(this.ga,a,"mousedown",this.Re,p);Qe(this.ga,a,
"deactivate",this.Qe)}else Qe(this.ga,a,"blur",this.Qe);"toggle_display"==this.zb?(this.h.style.visibility="visible",Ce(this.h,p)):"move_offscreen"==this.zb&&this.oa();this.Q=p;this.jc?(lc(this.jc,"end",this.Te,r,this),this.jc.play()):this.Te()}}else Se(this)};w.oa=fa;function Se(a,b){if(!a.Q||!a.dispatchEvent({type:"beforehide",target:b}))return r;a.ga&&a.ga.Rc();a.ac?(lc(a.ac,"end",wa(a.ne,b),r,a),a.ac.play()):a.ne(b);return p}
w.ne=function(a){"toggle_display"==this.zb?this.Yg?Le(this.Ce,0,this):this.Ce():"move_offscreen"==this.zb&&(this.h.style.left="-200px",this.h.style.top="-200px");this.Q=r;this.Pd(a)};w.Ce=function(){this.h.style.visibility="hidden";Ce(this.h,r)};w.Od=function(){return this.dispatchEvent("beforeshow")};w.Te=function(){this.Jd=xa();this.dispatchEvent("show")};w.Pd=function(a){xa();this.dispatchEvent({type:"hide",target:a})};
w.Re=function(a){a=a.target;!ne(this.h,a)&&(!this.ke||ne(this.ke,a))&&!(150>xa()-this.Jd)&&Se(this,a)};w.ig=function(a){27==a.keyCode&&Se(this,a.target)&&(a.preventDefault(),a.stopPropagation())};w.Qe=function(a){if(this.Of){var b=de(this.h);if(F||Qa){if(a=b.activeElement,!a||ne(this.h,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>xa()-this.Jd||Se(this)}};w.u=function(){Re.D.u.call(this);this.ga.ea();Pb(this.jc);Pb(this.ac);delete this.h;delete this.ga};function Te(a,b){this.xd=a instanceof V?a:new V(a,b)}C(Te,Me);Te.prototype.oa=function(a,b,c,d){Ge(te(a),0,a,b,this.xd,c,q,d)};function Ue(a,b){this.Dg=4;this.Rd=b||n;Re.call(this,a)}C(Ue,Re);Ue.prototype.Uc=function(a){this.Rd=a||n;this.Q&&this.oa()};Ue.prototype.oa=function(){if(this.Rd){var a=!this.Q&&"move_offscreen"!=this.zb,b=this.e();a&&(b.style.visibility="hidden",Ce(b,p));this.Rd.oa(b,this.Dg,this.Nh);a&&Ce(b,r)}};function Ve(a,b,c){this.la=c||(a?be(ee(a)):be());Ue.call(this,this.la.rb("div",{style:"position:absolute;display:none;"}));this.yd=new V(1,1);this.bb=new Kb;a&&We(this,a);if(b!=q)if(a=this.e(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(de(a).createTextNode(b))}}C(Ve,Ue);var Xe=[];w=Ve.prototype;w.M=q;w.className="goog-tooltip";
w.ef=500;w.Vf=0;w.Ec=s("la");function We(a,b){b=ee(b);a.bb.add(b);J(b,"mouseover",a.ze,r,a);J(b,"mouseout",a.Hc,r,a);J(b,"mousemove",a.ye,r,a);J(b,"focus",a.xe,r,a);J(b,"blur",a.Hc,r,a)}w.detach=function(a){if(a)a=ee(a),Ye(this,a),this.bb.remove(a);else{for(var b=this.bb.fa(),c=0;a=b[c];c++)Ye(this,a);this.bb.clear()}};function Ye(a,b){mc(b,"mouseover",a.ze,r,a);mc(b,"mouseout",a.Hc,r,a);mc(b,"mousemove",a.ye,r,a);mc(b,"focus",a.xe,r,a);mc(b,"blur",a.Hc,r,a)}
w.Sd=function(a){var b=this.e();b&&le(b);Ve.D.Sd.call(this,a);a&&(b=this.la.v.body,b.insertBefore(a,b.lastChild))};w.Od=function(){if(!Re.prototype.Od.call(this))return r;if(this.anchor)for(var a,b=0;a=Xe[b];b++)ne(a.e(),this.anchor)||a.r(r);0<=ob(Xe,this)||Xe.push(this);a=this.e();a.className=this.className;Ze(this);J(a,"mouseover",this.Be,r,this);J(a,"mouseout",this.Ae,r,this);$e(this);return p};
w.Pd=function(){tb(Xe,this);for(var a=this.e(),b,c=0;b=Xe[c];c++)b.anchor&&ne(a,b.anchor)&&b.r(r);this.We&&af(this.We);mc(a,"mouseover",this.Be,r,this);mc(a,"mouseout",this.Ae,r,this);this.anchor=n;if(0==(this.Aa?this.Q?4:1:this.sb?3:this.Q?2:0))this.Tc=r;Re.prototype.Pd.call(this)};w.Oe=function(a,b){this.anchor==a&&this.bb.contains(this.anchor)&&(this.Tc||!this.Oh?(this.r(r),this.Q||(this.anchor=a,this.Uc(b||bf(this,0)),this.r(p))):this.anchor=n);this.Aa=n};
w.fg=function(a){this.sb=n;a==this.anchor&&(this.M==q||this.M!=this.e()&&!this.bb.contains(this.M))&&(!this.le||!this.le.M)&&this.r(r)};function cf(a,b){var c=pe(a.la);a.yd.x=b.clientX+c.x;a.yd.y=b.clientY+c.y}w.ze=function(a){var b=df(this,a.target);this.M=b;Ze(this);b!=this.anchor&&(this.anchor=b,this.Aa||(this.Aa=Le(va(this.Oe,this,b,n),this.ef)),ef(this),cf(this,a))};function df(a,b){try{for(;b&&!a.bb.contains(b);)b=b.parentNode;return b}catch(c){return q}}
w.ye=function(a){cf(this,a);this.Tc=p};w.xe=function(a){this.M=a=df(this,a.target);this.Tc=p;if(this.anchor!=a){this.anchor=a;var b=bf(this,1);Ze(this);this.Aa||(this.Aa=Le(va(this.Oe,this,a,b),this.ef));ef(this)}};function bf(a,b){if(0==b){var c=a.yd.d();return new ff(c)}return new gf(a.M)}function ef(a){if(a.anchor)for(var b,c=0;b=Xe[c];c++)ne(b.e(),a.anchor)&&(b.le=a,a.We=b)}
w.Hc=function(a){var b=df(this,a.target),c=df(this,a.relatedTarget);b!=c&&(b==this.M&&(this.M=q),$e(this),this.Tc=r,this.Q&&(!a.relatedTarget||!ne(this.e(),a.relatedTarget))?af(this):this.anchor=n)};w.Be=function(){var a=this.e();this.M!=a&&(Ze(this),this.M=a)};w.Ae=function(a){var b=this.e();if(this.M==b&&(!a.relatedTarget||!ne(b,a.relatedTarget)))this.M=q,af(this)};function $e(a){a.Aa&&(Ke.clearTimeout(a.Aa),a.Aa=n)}
function af(a){if(2==(a.Aa?a.Q?4:1:a.sb?3:a.Q?2:0))a.sb=Le(va(a.fg,a,a.anchor),a.Vf)}function Ze(a){a.sb&&(Ke.clearTimeout(a.sb),a.sb=n)}w.u=function(){this.r(r);$e(this);this.detach();this.e()&&le(this.e());this.M=q;delete this.la;Ve.D.u.call(this)};function ff(a,b){Te.call(this,a,b)}C(ff,Te);ff.prototype.oa=function(a,b,c){b=te(a);b=we(b);c=c?new Xd(c.top+10,c.right,c.bottom,c.left+10):new Xd(10,0,0,10);Je(this.xd,a,4,c,b,9)&496&&Je(this.xd,a,4,c,b,5)};function gf(a){Ne.call(this,a,3)}C(gf,Ne);
gf.prototype.oa=function(a,b,c){var d=new V(10,0);Ge(this.element,this.oe,a,b,d,c,9)&496&&Ge(this.element,2,a,1,d,c,5)};function hf(a){this.h=a;this.Je=J(this.h,Ra?"DOMMouseScroll":"mousewheel",this)}C(hf,Uc);
hf.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.ma;if("mousewheel"==a.type){c=1;if(F||H&&(La||eb("532.0")))c=40;d=H&&Ja&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ia(a.wheelDeltaX)?(b=H&&Ja&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=H&&Ja&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ia(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;z(this.Me)&&Math.min(Math.max(b,-this.Me),this.Me);z(this.Ne)&&(c=Math.min(Math.max(c,-this.Ne),
this.Ne));b=new jf(d,a,0,c);try{this.dispatchEvent(b)}finally{b.ea()}};hf.prototype.u=function(){hf.D.u.call(this);nc(this.Je);delete this.Je};function jf(a,b,c,d){b&&this.xa(b,n);this.type="mousewheel";this.detail=a;this.zd=d}C(jf,dc);F||H&&eb("525");function kf(a){(!x(a)||!(a instanceof Element))&&g(Error("Could not add interactor to the given element."));Q.call(this);this._className="interactor";this.kb=a;this.gd=this.ce=this.be=this.de=this.ae=this.ee=q;this.fd=p;this.rightButtonDown=this.middleButtonDown=this.leftButtonDown=r;this.ed=new Hc(0,0);this.config={MOUSEWHEEL_ENABLED:p,MOUSECLICKS_ENABLED:p,KEYBOARD_ENABLED:p,HOVERING_ENABLED:p,CONTEXTMENU_ENABLED:r}}C(kf,Q);w=kf.prototype;
w.xa=function(){this.config.MOUSEWHEEL_ENABLED?(this.gd=new hf(this.kb),this.ee=J(this.gd,"mousewheel",this.ug.bind(this))):(nc(this.ee),this.gd=q);this.config.MOUSEWHEEL_ENABLED?(this.ae=J(this.kb,"mousedown",this.ng.bind(this)),this.de=J(this.kb,"mouseup",this.sg.bind(this))):(nc(this.ae),nc(this.de));this.kb.oncontextmenu=this.config.CONTEXTMENU_ENABLED?q:function(){return r};window.onkeydown=this.config.KEYBOARD_ENABLED?this.Se.bind(this):q;nc(this.be);nc(this.ce);this.be=J(this.kb,"mousemove",
this.pg.bind(this));this.ce=J(this.kb,"mouseout",this.qg.bind(this))};w.ng=function(a){0==a.button?this.leftButtonDown=p:1==a.button?this.middleButtonDown=p:2==a.button&&(this.rightButtonDown=p);eval("this.onMouseDown(this['leftButtonDown'],this['middleButtonDown'],this['rightButtonDown'])");lf(this);a.preventDefault()};w.mg=aa();
w.sg=function(a){0==a.button?this.leftButtonDown=r:1==a.button?this.middleButtonDown=r:2==a.button&&(this.rightButtonDown=r);eval("this.onMouseUp(this['leftButtonDown'],this['middleButtonDown'],this['rightButtonDown'])");lf(this);a.preventDefault()};w.rg=aa();w.qg=function(a){this.fd=r;this.config.KEYBOARD_ENABLED&&(window.onkeydown=q);this.rightButtonDown=this.middleButtonDown=this.leftButtonDown=r;lf(this);this.ed=new Hc(0,0);a.preventDefault()};w.og=aa();
w.pg=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.fd=p;this.config.KEYBOARD_ENABLED&&window.onkeydown==q&&(window.onkeydown=this.Se.bind(this));a.preventDefault();var b=a.shiftKey,c=new Hc(a.offsetX,a.offsetY),a=this.ed.pa(c);this.ed=c.d();this.config.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.middleButtonDown||this.leftButtonDown||this.rightButtonDown)&&lf(this),this.ad=setTimeout(function(){lf(this);var a=new Lc;a.yc=c.x;a.zc=c.y;this.dispatchEvent(a);
this.ad=q}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.eb()&&(this.leftButtonDown&&!b?(b=new Ic,b.jb=a,b.Lh=0,this.dispatchEvent(b)):this.middleButtonDown||this.leftButtonDown&&b?(b=new Ec,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.jb=a,this.dispatchEvent(b)):this.rightButtonDown&&(b=new Jc,b.Xa=0<a.y,b.Ca=r,this.dispatchEvent(b)))};function lf(a){a.ad&&clearTimeout(a.ad);a.dispatchEvent(new Mc)}w.tg=aa();
w.ug=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");lf(this);a.preventDefault();var b=new Jc;x(a.zd)||(a.zd=0);b.Xa=0>a.zd;b.Ca=p;this.dispatchEvent(b)};w.kg=aa();
w.Se=function(a){if(this.fd){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");lf(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,f=a.shiftKey,e=a.keyCode;if(82==e&&!b&&!c&&!d&&!f)a.preventDefault(),a=new Nc,this.dispatchEvent(a);else if(37<=e&&40>=e&&(a.preventDefault(),a=f?new Ec:b?new Jc:new Ic))c=new Hc(0,0),37==e?(c.x=5,b&&(a.Xa=p,a.Ca=r)):39==e?(c.x=-5,b&&(a.Xa=r,a.Ca=r)):38==e?(c.y=5,b&&(a.Xa=p,a.Ca=p)):40==e&&(c.y=-5,b&&(a.Xa=r,a.Ca=p)),a.jb=c,this.dispatchEvent(a)}};B("X.interactor",kf);
B("X.interactor.prototype.onMouseDown",kf.prototype.mg);B("X.interactor.prototype.onMouseUp",kf.prototype.rg);B("X.interactor.prototype.onMouseMove",kf.prototype.og);B("X.interactor.prototype.onMouseWheel",kf.prototype.tg);B("X.interactor.prototype.onKey",kf.prototype.kg);function mf(a,b,c,d){x(a)||g(Error("No valid parent element."));(!z(b)||!z(c))&&g(Error("Invalid coordinates."));(!x(d)||!(d instanceof kf))&&g(Error("Invalid interactor."));Ve.call(this);this._className="caption";this.Ma=a;this.yc=b;this.zc=c;this.lb=d;this.ua=q;this.Ua=[];this.Ua=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];lc(d,Dc,this.Id.bind(this));this.Hd()}C(mf,Ve);
mf.prototype.Hd=function(){this.Ma.style.position="relative";var a=document.getElementsByTagName("head")[0],b=he("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Ua[0]);a.appendChild(b);b.appendChild(c);this.ua=b;this.Uc(new Te(this.yc,this.zc));this.r(p);We(this,this.Ma);this.e().classList.add("x-tooltip")};mf.prototype.Id=function(){this.r(r);this.ua&&le(this.ua);this.e()&&le(this.e());this.ua=q};function nf(){Q.call(this);this._className="shader";this.xc="";this.xc="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.pc="";this.pc="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool useTextureThreshold;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelMapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\n\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelMapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelMapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (useTextureThreshold) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
C(nf,Q);var of={Eh:"vertexPosition",Dh:"vertexNormal",Ch:"vertexColor",Fh:"vertexTexturePos"},pf={Gh:"view",th:"perspective",nh:"center",sh:"objectTransform",yh:"useObjectColor",qh:"objectColor",uh:"pointSize",rh:"objectOpacity",ph:"normal",zh:"usePicking",Ah:"useTexture",Bh:"useTextureThreshold",xh:"useLabelMapTexture",oh:"labelMapOpacity",vh:"textureSampler",wh:"textureSampler2",Hh:"volumeLowerThreshold",Kh:"volumeUpperThreshold",Jh:"volumeScalarMin",Ih:"volumeScalarMax"};
function qf(a){var b=Object.keys(pf);Object.keys(of).every(function(a){a=eval("X.shaders.attributes."+a);return-1!=this.xc.search(a)||-1!=this.pc.search(a)}.bind(a))||g(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=eval("X.shaders.uniforms."+a);return-1!=this.xc.search(a)||-1!=this.pc.search(a)}.bind(a))||g(Error("Could not find all uniforms in the shader sources."))}B("X.shaders.attributes",of);B("X.shaders.uniforms",pf);function rf(a,b,c){x(a)||g(Error("Invalid GL Buffer."));x(b)||g(Error("Invalid number of items."));x(c)||g(Error("Invalid item size."));Q.call(this);this._className="buffer";this.W=a;this.Ea=b;this.mb=c}C(rf,Q);function sf(a){this.$a=a||tf}function tf(a,b){return""+a<""+b?-1:""+a>""+b?1:0}w=sf.prototype;w.S=q;w.$a=q;w.za=q;w.ya=q;w.g=0;
w.add=function(a){if(this.S==q)return this.ya=this.za=this.S=new uf(a),this.g=1,p;var b=r;vf(this,function(c){var d=q;if(0<this.$a(c.value,a)){if(d=c.left,c.left==q){var f=new uf(a,c);c.left=f;c==this.za&&(this.za=f);b=p;wf(this,c)}}else 0>this.$a(c.value,a)&&(d=c.right,c.right==q&&(f=new uf(a,c),c.right=f,c==this.ya&&(this.ya=f),b=p,wf(this,c)));return d});b&&(this.g+=1);return b};
w.remove=function(a){var b=q;vf(this,function(c){var d=q;if(0<this.$a(c.value,a))d=c.left;else if(0>this.$a(c.value,a))d=c.right;else if(b=c.value,c.left!=q||c.right!=q){var f=q,e;if(c.left!=q){e=xf(this,c.left);if(e!=c.left){if(e.parent.right=e.left)e.left.parent=e.parent;e.left=c.left;e.left.parent=e;f=e.parent}e.parent=c.parent;e.right=c.right;e.right&&(e.right.parent=e);c==this.ya&&(this.ya=e)}else{e=yf(this,c.right);if(e!=c.right){if(e.parent.left=e.right)e.right.parent=e.parent;e.right=c.right;
e.right.parent=e;f=e.parent}e.parent=c.parent;e.left=c.left;e.left&&(e.left.parent=e);c==this.za&&(this.za=e)}zf(c)?c.parent.left=e:Af(c)?c.parent.right=e:this.S=e;wf(this,f?f:e)}else zf(c)?(c.parent.left=q,c==this.za&&(this.za=c.parent),wf(this,c.parent)):Af(c)?(c.parent.right=q,c==this.ya&&(this.ya=c.parent),wf(this,c.parent)):this.clear();return d});b&&(this.g=this.S?this.g-1:0);return b};w.clear=function(){this.ya=this.za=this.S=q;this.g=0};
w.contains=function(a){var b=r;vf(this,function(c){var d=q;0<this.$a(c.value,a)?d=c.left:0>this.$a(c.value,a)?d=c.right:b=p;return d});return b};w.N=s("g");w.Zb=function(){return yf(this).value};w.Yb=function(){return xf(this).value};w.fa=function(){var a=[];Bf(this,function(b){a.push(b)});return a};
function Bf(a,b){if(a.S){var c,d=c=yf(a);for(c=c.left?c.left:c;d!=q;)if(d.left!=q&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var f=d,d=d.right!=q&&d.right!=c?d.right:d.parent;c=f}}}function vf(a,b,c){for(c=c?c:a.S;c&&c!=q;)c=b.call(a,c)}
function wf(a,b){vf(a,function(a){var b=a.left?a.left.height:0,f=a.right?a.right.height:0;1<b-f?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Cf(this,a.left),Df(this,a)):1<f-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Df(this,a.right),Cf(this,a));b=a.left?a.left.height:0;f=a.right?a.right.height:0;a.height=Math.max(b,f)+1;return a.parent},b)}
function Cf(a,b){zf(b)?(b.parent.left=b.right,b.right.parent=b.parent):Af(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.S=b.right,a.S.parent=q);var c=b.right;b.right=b.right.left;b.right!=q&&(b.right.parent=b);c.left=b;b.parent=c}function Df(a,b){zf(b)?(b.parent.left=b.left,b.left.parent=b.parent):Af(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.S=b.left,a.S.parent=q);var c=b.left;b.left=b.left.right;b.left!=q&&(b.left.parent=b);c.right=b;b.parent=c}
function yf(a,b){if(!b)return a.za;var c=b;vf(a,function(a){var b=q;a.left&&(b=c=a.left);return b},b);return c}function xf(a,b){if(!b)return a.ya;var c=b;vf(a,function(a){var b=q;a.right&&(b=c=a.right);return b},b);return c}function uf(a,b){this.value=a;this.parent=b?b:q}uf.prototype.left=q;uf.prototype.right=q;uf.prototype.height=1;function Af(a){return!!a.parent&&a.parent.right==a}function zf(a){return!!a.parent&&a.parent.left==a};function Ef(){}(function(a){a.we=function(){return a.Yf||(a.Yf=new a)}})(Ef);Ef.prototype.Md=0;Ef.we();function Ff(a){this.la=a||be()}C(Ff,Uc);w=Ff.prototype;w.Xf=Ef.we();w.De=q;w.cb=r;w.h=q;w.ub=q;w.qb=q;w.Sb=q;w.mh=r;w.e=s("h");w.Ud=function(a){this.ub&&this.ub!=a&&g(Error("Method not supported"));Ff.D.Ud.call(this,a)};w.Ec=s("la");w.rb=function(){this.h=this.la.createElement("div")};w.fc=function(a){this.xb(a)};w.xb=function(a,b){this.cb&&g(Error("Component already rendered"));this.h||this.rb();a?a.insertBefore(this.h,b||q):this.la.v.body.appendChild(this.h);(!this.ub||this.ub.cb)&&this.Dc()};
w.Dc=function(){this.cb=p;Gf(this,function(a){!a.cb&&a.e()&&a.Dc()})};w.Vb=function(){Gf(this,function(a){a.cb&&a.Vb()});this.Gc&&this.Gc.Rc();this.cb=r};w.u=function(){Ff.D.u.call(this);this.cb&&this.Vb();this.Gc&&(this.Gc.ea(),delete this.Gc);Gf(this,function(a){a.ea()});!this.mh&&this.h&&le(this.h);this.ub=this.h=this.Sb=this.qb=q};w.$b=function(){return!!this.qb&&0!=this.qb.length};function Gf(a,b){a.qb&&pb(a.qb,b,n)}
w.removeChild=function(a,b){if(a){var c=y(a)?a:a.De||(a.De=":"+(a.Xf.Md++).toString(36)),a=this.Sb&&c?(c in this.Sb?this.Sb[c]:n)||q:q;if(c&&a){var d=this.Sb;c in d&&delete d[c];tb(this.qb,a);b&&(a.Vb(),a.h&&le(a.h));c=a;c==q&&g(Error("Unable to set parent component"));c.ub=q;Ff.D.Ud.call(c,q)}}a||g(Error("Child is not in parent component"));return a};function Hf(){}C(Hf,Uc);w=Hf.prototype;w.Yd=0;w.cc=0;w.Ld=100;w.ve=0;w.Xd=1;w.$f=r;w.gg=r;w.Wc=function(a){a=If(this,a);this.Yd!=a&&(this.Yd=a+this.ve>this.Ld?this.Ld-this.ve:a<this.cc?this.cc:a,!this.$f&&!this.gg&&this.dispatchEvent("change"))};w.Fc=function(){return If(this,this.Yd)};w.Zb=function(){return If(this,this.cc)};w.Yb=function(){return If(this,this.Ld)};function If(a,b){return a.Xd==q?b:a.cc+Math.round((b-a.cc)/a.Xd)*a.Xd};function Jf(a){this.la=a||be();this.vb=new Hf;J(this.vb,"change",this.Uf,r,this)}C(Jf,Ff);var Kf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};w=Jf.prototype;w.rb=function(){this.ia=this.Ec().rb("div","progress-bar-thumb");var a=Kf[this.Ue];this.h=this.Ec().rb("div",a,this.ia);Lf(this);this.e().setAttribute("aria-valuemin",this.Zb());this.e().setAttribute("aria-valuemax",this.Yb())};
w.Dc=function(){Jf.D.Dc.call(this);F&&7>Wa&&J(this.e(),"resize",this.Yc,r,this);this.Yc();var a=this.e();a.setAttribute("role","progressbar");a.Ph="progressbar";this.e().setAttribute("aria-live","polite")};w.Vb=function(){Jf.D.Vb.call(this);Mf(this)};function Mf(a){F&&7>Wa&&mc(a.e(),"resize",a.Yc,r,a)}w.Fc=function(){return this.vb.Fc()};w.Wc=function(a){this.vb.Wc(a);this.e()&&Lf(this)};function Lf(a){var b=a.Fc();a.e().setAttribute("aria-valuenow",b)}w.Zb=function(){return this.vb.Zb()};w.Yb=function(){return this.vb.Yb()};
w.Ue="horizontal";w.Uf=function(){this.Yc();this.dispatchEvent("change")};w.Yc=function(){if(this.ia){var a=this.Zb(),b=this.Yb(),a=(this.Fc()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Ue?F&&7>Wa?(this.ia.style.top=0,this.ia.style.height="100%",b=this.ia.offsetHeight,a=Math.round(a*b),this.ia.style.top=b-a+"px",this.ia.style.height=a+"px"):(this.ia.style.top=100-b+"%",this.ia.style.height=b+"%"):this.ia.style.width=b+"%"}};w.u=function(){Mf(this);Jf.D.u.call(this);this.ia=q;this.vb.ea()};function Nf(a,b){x(a)||g(Error("No valid parent element."));x(b)||g(Error("Invalid initial value."));Jf.call(this);this._className="progressbar";this.Ma=a;this.oc=this.ua=q;this.Ua=[];this.Ua=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.Wc(b);this.Hd()}C(Nf,Jf);
Nf.prototype.Hd=function(){this.Ma.style.position="relative";var a=document.getElementsByTagName("head")[0],b=he("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Ua[0]),d=document.createTextNode(this.Ua[1]),f=document.createTextNode(this.Ua[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(f);this.ua=b;this.fc(this.Ma);a=this.e();a.style.position="absolute";a.style.top=(this.Ma.clientHeight-5)/2;a.style.left=(this.Ma.clientWidth-100)/2};
function Of(a){var b=a.e().style.top,c=a.e().style.left;le(a.e());var d=new Nf(a.Ma,100),f=d.e();f.style.position="absolute";f.style.top=b;f.style.left=c;(f.firstElementChild!=n?f.firstElementChild:me(f.firstChild)).classList.add("progress-bar-thumb-done");a.oc=d}Nf.prototype.Id=function(){this.ua&&le(this.ua);this.e()&&le(this.e());this.oc&&le(this.oc.e());this.oc=this.ua=q};function Pf(a,b){(!z(a)||!z(b))&&g(Error("A camera needs valid width and height values."));Q.call(this);this._className="camera";this.wf=45;this.rc=new P(0,0,100);this.Db=new P(0,0,0);this.Za=new P(0,1,0);var c=Float32Array,d;d=a/b;var f=1*Math.tan(this.wf*Math.PI/360),e=-f;d=new Y([[2/(f*d-e*d),0,(f*d+e*d)/(f*d-e*d),0],[0,2/(f-e),(f+e)/(f-e),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.yf=new c(d.B());this.l=Qf(this,this.rc,this.Db);this.Va=new Float32Array(this.l.B())}C(Pf,Q);w=Pf.prototype;
w.zg=function(a){a instanceof Jc||g(Error("Received no valid zoom event."));a.Xa?this.qf(a.Ca):this.rf(a.Ca)};w.vg=function(a){a instanceof Ec||g(Error("Received no valid pan event."));this.Ve(a.jb)};w.xg=function(a){a instanceof Ic||g(Error("Received no valid rotate event."));this.rotate(a.jb)};w.view=s("l");w.Vg=function(a){(!x(a)||!(a instanceof Y))&&g(Error("Invalid view matrix."));this.l=a;this.Va=new Float32Array(this.l.B())};w.position=s("rc");
w.Uc=function(a,b,c){(!z(a)||!z(b)||!z(c))&&g(Error("The position was invalid."));this.rc=new P(a,b,c);this.reset()};w.reset=function(){this.l=Qf(this,this.rc,this.Db);this.Va=new Float32Array(this.l.B())};w.focus=s("Db");w.Og=function(a,b,c){(!z(a)||!z(b)||!z(c))&&g(Error("The focus was invalid."));this.Db=new P(a,b,c);this.reset()};w.jh=s("Za");w.Ug=function(a,b,c){(!z(a)||!z(b)||!z(c))&&g(Error("The up-vector was invalid."));this.Za=new P(a,b,c);this.reset()};
w.Ve=function(a){a instanceof Hc||g(Error("Invalid distance vector for pan operation."));a=new P(-a.x,a.y,0);a=Cd(4).translate(a);this.l=new Y(a.multiply(this.l));this.Va=new Float32Array(this.l.B());this.dispatchEvent(new Kc)};
w.rotate=function(a){a instanceof Array&&2==a.length?a=new Hc(a[0],a[1]):a instanceof Hc||g(Error("Invalid distance vector for rotate operation."));var b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=Cd(4),d=new P(parseFloat(zd(this.l,0,0)),parseFloat(zd(this.l,0,1)),parseFloat(zd(this.l,0,2))),b=c.rotate(b,new P(parseFloat(zd(this.l,1,0)),parseFloat(zd(this.l,1,1)),parseFloat(zd(this.l,1,2)))),a=c.rotate(a,d);this.l=new Y(this.l.multiply(a.multiply(b)));this.Va=new Float32Array(this.l.B());this.dispatchEvent(new Kc)};
w.qf=function(a){var b=20;x(a)&&!a&&(b=1);a=new P(0,0,b);a=Cd(4).translate(a);this.l=new Y(a.multiply(this.l));this.Va=new Float32Array(this.l.B());this.dispatchEvent(new Kc)};w.rf=function(a){var b=30;x(a)&&!a&&(b=1);a=new P(0,0,-b);a=Cd(4).translate(a);this.l=new Y(a.multiply(this.l));this.Va=new Float32Array(this.l.B());this.dispatchEvent(new Kc)};
function Qf(a,b,c){(!(b instanceof P)||!(c instanceof P))&&g(Error("3D vectors required for calculating the view."));var d=Cd(4),c=new P(b.x-c.x,b.y-c.y,b.b-c.b),c=c.normalize(),a=a.Za.d();a.Tb(c)&&(a.b+=1.0E-6);var f=Tc(a,c),a=Tc(c,f),f=f.normalize(),a=a.normalize();W(d,0,0,f.x);W(d,0,1,f.y);W(d,0,2,f.b);W(d,0,3,0);W(d,1,0,a.x);W(d,1,1,a.y);W(d,1,2,a.b);W(d,1,3,0);W(d,2,0,c.x);W(d,2,1,c.y);W(d,2,2,c.b);W(d,2,3,0);W(d,3,0,0);W(d,3,1,0);W(d,3,2,0);W(d,3,3,1);b=b.d();return d.translate(b.C())}
B("X.camera",Pf);B("X.camera.prototype.view",Pf.prototype.view);B("X.camera.prototype.setView",Pf.prototype.Vg);B("X.camera.prototype.position",Pf.prototype.position);B("X.camera.prototype.setPosition",Pf.prototype.Uc);B("X.camera.prototype.focus",Pf.prototype.focus);B("X.camera.prototype.setFocus",Pf.prototype.Og);B("X.camera.prototype.up",Pf.prototype.jh);B("X.camera.prototype.setUp",Pf.prototype.Ug);B("X.camera.prototype.pan",Pf.prototype.Ve);B("X.camera.prototype.rotate",Pf.prototype.rotate);
B("X.camera.prototype.zoomIn",Pf.prototype.qf);B("X.camera.prototype.zoomOut",Pf.prototype.rf);function $(a){x(a)||g(Error("An ID to a valid container (<div>..) is required."));a=ee(a);(!(na(a)&&1==a.nodeType)||0==a.clientWidth||0==a.clientHeight)&&g(Error("Could not find the given container or it has an undefined size."));Q.call(this);this._className="renderer";this.sa=a;this.ob=this.sa.clientWidth;this.Wa=this.sa.clientHeight;this.lb=this.m=this.ld=this.md=this.a=this.ra=q;this.La=new sf(Jd);this.Ob=[];this.Hb=this.Kb=this.Gb=this.Jb=this.Fb=this.Ib=q;this.j=[0,0,0];this.fe=q;this.Zc=new Eb;
this.Pb=new Eb;this.Qb=new Eb;this.hd=new Eb;this.nc=new Eb;this.uc=new Eb;this.vc=new Eb;this.ka=this.Eb=q;this.qc=r;this.config={PROGRESSBAR_ENABLED:p,PICKING_ENABLED:p,ORDERING_ENABLED:p,STATISTICS_ENABLED:r};window.console.log("XTK Release 3b -- 03/31/12 -- http://www.goXTK.com")}C($,Q);w=$.prototype;w.width=s("ob");w.height=s("Wa");w.canvas=function(){x(this.ra)||(this.ra=he("canvas"));return this.ra};w.Jf=s("sa");w.Ff=s("m");w.Zf=s("lb");
function Rf(a){x(a.Eb)||(a.Eb=new Pd,J(Rf(a),Bc,a.wg.bind(a)));return a.Eb}w.wg=function(a){this.ka&&this.ka.Wc(100*a.ie)};w.lg=function(a){x(a)&&a instanceof Oc&&Sf(this,a.ba)};w.jg=function(a){if(x(a)&&a instanceof Lc){var b=a.yc,a=a.zc,c=this.get(this.Xe(b,a));if(c&&(c=c.caption()))(new mf(this.sa,this.sa.offsetLeft+b+10,this.sa.offsetTop+a+10,this.lb)).e().innerHTML=c}};w.Fg=function(){this.Hb=this.Kb=this.Gb=this.Jb=this.Fb=this.Ib=q;this.j=[0,0,0]};
function Tf(a){a.config.PROGRESSBAR_ENABLED&&a.ka&&!a.he&&(Of(a.ka),a.he=Le(function(){this.he=q;this.ka&&(this.ka.Id(),this.ka=q);this.fc()}.bind(a),700))}w.af=function(){this.m.reset();this.xb(r,r)};
w.xa=function(){var a=this.canvas();a.width=this.width();a.height=this.height();this.sa.appendChild(a);try{var b=a.getContext("experimental-webgl");b||g(Error())}catch(c){this.sa.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">Sorry, WebGL is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..</p>',g(Error('Sorry, WebGL is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..'))}try{if(b.viewport(0,
0,this.width(),this.height()),b.clearColor(0,0,0,0),b.enable(b.BLEND),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),this.config.PICKING_ENABLED){var d=b.createFramebuffer(),f=b.createRenderbuffer(),e=b.createTexture();b.bindTexture(b.TEXTURE_2D,e);b.texImage2D(b.TEXTURE_2D,0,b.RGB,this.width(),this.height(),0,b.RGB,b.UNSIGNED_BYTE,q);b.bindFramebuffer(b.FRAMEBUFFER,d);b.bindRenderbuffer(b.RENDERBUFFER,
f);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,this.width(),this.height());b.bindRenderbuffer(b.RENDERBUFFER,q);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,f);b.bindFramebuffer(b.FRAMEBUFFER,q);this.fe=d}}catch(h){g(Error("Exception while accessing GL Context!\n"+h))}d=new kf(a);d.xa();J(d,Ac,this.af.bind(this));J(d,Cc,this.jg.bind(this));f=new Pf(this.width(),this.height());(!x(d)||
!(d instanceof kf))&&g(Error("Could not observe the interactor."));J(d,wc,f.vg.bind(f));J(d,xc,f.xg.bind(f));J(d,yc,f.zg.bind(f));J(f,zc,this.xb.bind(this,r,r));this.ra=a;this.a=b;this.m=f;this.lb=d;Uf(this)};
function Uf(a){var b=new nf;(!x(a.ra)||!x(a.a)||!x(a.m))&&g(Error("Renderer was not initialized properly."));(!x(b)||!(b instanceof nf))&&g(Error("Could not add shaders."));qf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.pc);a.a.shaderSource(d,b.xc);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||g(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
g(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var f=a.a.createProgram();a.a.attachShader(f,d);a.a.attachShader(f,c);a.a.linkProgram(f);a.a.getProgramParameter(f,a.a.LINK_STATUS)||g(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(f)));a.a.useProgram(f);a.ld=f;Object.keys(of).forEach(function(a){a=eval("X.shaders.attributes."+a);this.Zc.set(a,this.a.getAttribLocation(this.ld,a));this.a.enableVertexAttribArray(this.Zc.get(a))}.bind(a));
Object.keys(pf).forEach(function(a){a=eval("X.shaders.uniforms."+a);this.Pb.set(a,this.a.getUniformLocation(this.ld,a))}.bind(a));a.md=b}w.add=function(a){this.Ob.push(a);Sf(this,a)};
function Sf(a,b){(!x(a.ra)||!x(a.a)||!x(a.m))&&g(Error("Renderer was not initialized properly."));(!x(b)||!(b instanceof L))&&g(Error("Illegal object."));var c=r;a.get(b.id())&&(c=p);qc(b)||J(b,rc,a.lg.bind(a));var d=b.id(),f=b.k,e=b.p,h=b.$,i=b.K,j=b.file(),o=b.transform(),k=b.o,m=b.I;if(x(m)&&x(m.file())&&m.file().c)Sf(a,m);else if(x(k)&&x(k.file())&&k.file().c)c=Rf(a),x(b.o)||g(Error("Internal error during file loading.")),d=b.o.file().path(),h=new XMLHttpRequest,J(h,"abort",c.Kc.bind(c,h,b)),
J(h,"error",c.Kc.bind(c,h,b)),J(h,"load",c.bg.bind(c,h,b)),h.open("GET",d,p),h.overrideMimeType("text/plain; charset=x-user-defined"),h.setRequestHeader("Content-Type","text/plain"),h.send(q),Qd(c).set(b.o.id(),r);else if(x(i)&&x(i.file())&&i.file().c)c=Rf(a),x(b.K)||g(Error("Internal error during texture loading.")),d=new Image,h=b.K.file().path(),d.src=h,b.K.$d=d,lc(d,"load",c.dg.bind(c,b)),Qd(c).set(b.id(),r),Sd(c,0.3);else if(x(j)&&j.c)c=Rf(a),x(b.file())||g(Error("Internal error during file loading.")),
d=b.id(),Ib(c.nb.q,d)||(b.k.clear(),b.p.clear(),d=b.file().path(),h=d.split(".").pop(),h=h.toUpperCase(),"TRK"==h||"STL"==h||"FSM"==h||"VTK"==h||"NRRD"==h||g(Error("The "+h+" file format is not supported.")),h=new XMLHttpRequest,J(h,"abort",c.Kc.bind(c,h,b)),J(h,"error",c.Kc.bind(c,h,b)),J(h,"load",c.cg.bind(c,h,b)),h.open("GET",d,p),h.overrideMimeType("text/plain; charset=x-user-defined"),h.setRequestHeader("Content-Type","text/plain"),h.send(q),Qd(c).set(b.id(),r));else{if(b.c&&b.$b()){j=b.children();
k=j.length;for(m=m=0;m<k;m++)Sf(a,j[m])}if(0==f.count())Vc(b);else{for(j=0;a.qc;)j++;a.qc=p;k=b instanceof Td&&b.Pa instanceof Wd;c&&x(i)&&i.c&&(j=a.uc.get(d),x(j)&&a.a.isBuffer(j.W)&&a.a.deleteBuffer(j.W));j=q;x(i)&&(!c||i.c?(j=b.Ya,x(j)||g(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),m=a.a.createTexture(),m.Fd=i.Fd(),a.vc.set(i.id(),m),a.a.bindTexture(a.a.TEXTURE_2D,m),i.Mb?(a.a.texImage2D(a.a.TEXTURE_2D,0,a.a.RGBA,i.tc,i.sc,0,a.a.RGBA,
a.a.UNSIGNED_BYTE,i.Mb),a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_WRAP_S,a.a.CLAMP_TO_EDGE),a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_WRAP_T,a.a.CLAMP_TO_EDGE),a.a.pixelStorei(a.a.UNPACK_FLIP_Y_WEBGL,p)):(a.a.texImage2D(a.a.TEXTURE_2D,0,a.a.RGBA,a.a.RGBA,a.a.UNSIGNED_BYTE,m.Fd),a.a.pixelStorei(a.a.UNPACK_FLIP_Y_WEBGL,r)),k?(a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_MAG_FILTER,a.a.NEAREST),a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_MIN_FILTER,a.a.NEAREST)):(a.a.texParameteri(a.a.TEXTURE_2D,
a.a.TEXTURE_MAG_FILTER,a.a.LINEAR),a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_MIN_FILTER,a.a.LINEAR)),a.a.bindTexture(a.a.TEXTURE_2D,q),m=a.a.createBuffer(),a.a.bindBuffer(a.a.ARRAY_BUFFER,m),a.a.bufferData(a.a.ARRAY_BUFFER,new Float32Array(j),a.a.STATIC_DRAW),j=new rf(m,j.length,2),Vc(i)):j=a.uc.get(d));Sd(Rf(a),0.1);if(k)a.qc=r,Sd(Rf(a),0.9);else{if(f.c||o.c){k=o.f;i=k.ha(new P(f.Ia,f.Ja,f.Ka));k=k.ha(new P(f.Fa,f.Ga,f.Ha));if(a.Ib===q||i.x<a.Ib)a.Ib=i.x;if(a.Fb===q||k.x>a.Fb)a.Fb=k.x;if(a.Jb===
q||i.y<a.Jb)a.Jb=i.y;if(a.Gb===q||k.y>a.Gb)a.Gb=k.y;if(a.Kb===q||i.b<a.Kb)a.Kb=i.b;if(a.Hb===q||k.b>a.Hb)a.Hb=k.b;a.j=[(a.Ib+a.Fb)/2,(a.Jb+a.Gb)/2,(a.Kb+a.Hb)/2];Vc(o)}c&&f.c&&(o=a.Qb.get(d),x(o)&&a.a.isBuffer(o.W)&&a.a.deleteBuffer(o.W));o=q;!c||f.c?(o=a.a.createBuffer(),a.a.bindBuffer(a.a.ARRAY_BUFFER,o),a.a.bufferData(a.a.ARRAY_BUFFER,new Float32Array(f.all()),a.a.STATIC_DRAW),o=new rf(o,f.count(),3),Vc(f)):o=a.Qb.get(d);Sd(Rf(a),0.3);c&&e.c&&(i=a.Qb.get(d),x(i)&&a.a.isBuffer(i.W)&&a.a.deleteBuffer(i.W));
i=q;!c||e.c?(i=a.a.createBuffer(),a.a.bindBuffer(a.a.ARRAY_BUFFER,i),a.a.bufferData(a.a.ARRAY_BUFFER,new Float32Array(e.all()),a.a.STATIC_DRAW),i=new rf(i,e.count(),3),Vc(e)):i=a.hd.get(d);Sd(Rf(a),0.3);c&&h.c&&(e=a.nc.get(d),x(e)&&a.a.isBuffer(e.W)&&a.a.deleteBuffer(e.W));e=q;0<h.length()&&(!c||h.c?(h.length()!=f.length()&&g(Error("Mismatch between points and point colors.")),f=a.a.createBuffer(),a.a.bindBuffer(a.a.ARRAY_BUFFER,f),a.a.bufferData(a.a.ARRAY_BUFFER,new Float32Array(h.all()),a.a.STATIC_DRAW),
e=new rf(f,h.count(),3),Vc(h)):e=a.nc.get(d));Sd(Rf(a),0.3);!c&&!a.La.add(b)&&g(Error("Could not add object to this renderer."));a.Qb.set(d,o);a.hd.set(d,i);a.nc.set(d,e);a.uc.set(d,j);Vc(b);a.qc=r}}}}
w.fc=function(){(!this.ra||!this.a||!this.m)&&g(Error("The renderer was not initialized properly."));x(this.ge)||(Rd(Rf(this))?this.ka?(Tf(this),eval("this.onShowtime()")):this.xb(r,p):(this.config.PROGRESSBAR_ENABLED&&!this.ka&&(this.ka=new Nf(this.sa,3)),this.ge=Le(function(){this.ge=q;this.fc()}.bind(this),100)))};w.yg=aa();w.get=function(a){x(a)||g(Error("Invalid object id."));for(var b=this.La.fa(),c=0,d=b.length,c=0;c<d;c++)if(b[c].id()==a)return b[c];return q};
w.Xe=function(a,b){if(this.config.PICKING_ENABLED){this.xb(p,r);var c=new Uint8Array(4);this.a.readPixels(a,this.Wa-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);var d=Math.round(10*(c[0]/255)),f=Math.round(10*(c[1]/255)),c=Math.round(10*(c[2]/255));return 100*d+10*f+c}return-1};
w.xb=function(a,b){var c=this.La.fa(),d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.fe):this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.a.viewport(0,0,this.ob,this.Wa);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var f=this.m.yf,e=this.m.Va;this.a.uniformMatrix4fv(this.Pb.get("perspective"),r,f);this.a.uniformMatrix4fv(this.Pb.get("view"),r,e);f=this.j;this.a.uniform3f(this.Pb.get("center"),parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2]));if(this.config.ORDERING_ENABLED)a:{var h=
r,f=this.La.fa(),e=f.length,i;i=e-1;do{var j=f[i];if(!j)break a;var o=j._opacity,k=j.Pa;j instanceof Td&&(o=k&&k._volumeRendering?j._opacity=j.Pa._opacity:j._opacity=1);1!=o&&(h=j.k.mc,j=this.m.l.ha(j.wc.f.ha(new P(h[0],h[1],h[2]))),j=Rc(this.m.Db,j),f[i].Cc=j,h=p)}while(i--);if(h){this.La.clear();i=e-1;do this.La.add(f[i]);while(i--)}}if(f=!a&&x(b)&&b&&this.config.STATISTICS_ENABLED)var m=0,l=0,t=0,u=0;i=this.Ob.length;for(e=0;e<i;++e)if(j=this.Ob[e],j instanceof Ud){var v=new P(1,0,0),v=this.m.view().ha(v),
h=Rc(this.m.focus(),v),v=new P(-1,0,0),v=this.m.view().ha(v),o=Rc(this.m.focus(),v),v=new P(0,1,0),v=this.m.view().ha(v),k=Rc(this.m.focus(),v),v=new P(0,-1,0),v=this.m.view().ha(v),E=Rc(this.m.focus(),v),v=new P(0,0,1),v=this.m.view().ha(v),D=Rc(this.m.focus(),v),v=new P(0,0,-1),v=this.m.view().ha(v),v=Rc(this.m.focus(),v),I=Math.max(h,k,D,o,E,v);I==h||I==o?Vd(j,0):I==k||I==E?Vd(j,1):(I==D||I==v)&&Vd(j,2)}e=this.Zc;i=e.get("vertexPosition");var j=e.get("vertexNormal"),h=e.get("vertexColor"),o=e.get("vertexTexturePos"),
e=this.Pb,k=e.get("usePicking"),E=e.get("useObjectColor"),D=e.get("objectColor"),v=e.get("objectOpacity"),I=e.get("labelMapOpacity"),G=e.get("useTexture"),A=e.get("useTextureThreshold"),N=e.get("useLabelMapTexture"),ba=e.get("textureSampler"),ha=e.get("textureSampler2"),jb=e.get("volumeLowerThreshold"),Gc=e.get("volumeUpperThreshold"),ab=e.get("volumeScalarMin"),sd=e.get("volumeScalarMax"),fc=e.get("objectTransform"),Fc=e.get("pointSize"),e=d;do{var M=c[d-e];if(M){var O=q;M instanceof Td&&M.Pa&&(O=
M.Pa);if(M._visible&&(!O||O._visible)){var Z=M._id,T=M._magicMode,la=this.Qb.get(Z),pa=this.hd.get(Z),ca=this.nc.get(Z),Ka=this.uc.get(Z);this.a.bindBuffer(this.a.ARRAY_BUFFER,la.W);this.a.vertexAttribPointer(i,la.mb,this.a.FLOAT,r,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,pa.W);this.a.vertexAttribPointer(j,pa.mb,this.a.FLOAT,r,0,0);a?this.a.uniform1i(k,p):this.a.uniform1i(k,r);ca&&!a&&!T?(this.a.uniform1i(E,r),this.a.bindBuffer(this.a.ARRAY_BUFFER,ca.W),this.a.vertexAttribPointer(h,ca.mb,this.a.FLOAT,
r,0,0)):(pa=1,T&&!a&&(pa=0),this.a.uniform1i(E,pa),T=M._color,a&&(999<Z&&g(Error("Id out of bounds.")),T=Math.floor(0.01*Z),pa=Math.floor(0.1*Z)-10*T,T=[T/10,pa/10,(Z-100*T-10*pa)/10]),this.a.uniform3f(D,parseFloat(T[0]),parseFloat(T[1]),parseFloat(T[2])),this.a.vertexAttribPointer(h,la.mb,this.a.FLOAT,r,0,0));this.a.uniform1f(v,parseFloat(M._opacity));M.K&&Ka&&!a?(this.a.uniform1i(G,p),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.vc.get(M.K._id)),this.a.uniform1i(ba,
0),this.a.bindBuffer(this.a.ARRAY_BUFFER,Ka.W),this.a.vertexAttribPointer(o,Ka.mb,this.a.FLOAT,r,0,0),this.a.uniform1i(A,r)):(this.a.uniform1i(G,r),this.a.vertexAttribPointer(o,la.mb,this.a.FLOAT,r,0,0));O&&(this.a.uniform1i(A,p),this.a.uniform1f(jb,O._lowerThreshold),this.a.uniform1f(Gc,O._upperThreshold),Z=O.Nb,this.a.uniform1f(ab,Z[0]),this.a.uniform1f(sd,Z[1]),Z=O.I,this.a.uniform1i(N,r),O._volumeRendering?this.a.uniform1f(v,parseFloat(O._opacity)):Z&&Z._visible&&(O=M.I._id,this.a.uniform1i(N,
p),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.vc.get(O)),this.a.uniform1i(ha,1),this.a.uniform1f(I,Z._opacity)));this.a.uniformMatrix4fv(fc,r,M.wc.ta);O=1;"POINTS"==M._type&&(O=M._pointSize);this.a.uniform1f(Fc,O);O=-1;M.type()==Gd?(O=this.a.TRIANGLES,f&&(l+=la.Ea/3)):M.type()==bd?(this.a.lineWidth(M.lineWidth()),O=this.a.LINES,f&&(t+=la.Ea/2)):"POINTS"==M.type()?(O=this.a.POINTS,f&&(u+=la.Ea)):"TRIANGLE_STRIPS"==M.type()?(O=this.a.TRIANGLE_STRIP,f&&(l+=la.Ea/
3)):"POLYGONS"==M.type()&&(O=0==la.Ea%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(l+=la.Ea/3));f&&(m+=la.Ea);this.a.drawArrays(O,0,la.Ea)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+m+" | ")+("Triangles: "+Math.round(l)+" | "),c=c+("Lines: "+t+" | ")+("Points: "+u+" | ")+("Textures: "+this.vc.N()),window.console.log(c))}};
w.Lf=function(){this.La.clear();delete this.La;this.Ob.length=0;delete this.Ob;this.md=q;delete this.md;this.Eb=q;delete this.Eb;this.m=q;delete this.m;this.lb=q;delete this.lb;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);this.a=q;delete this.a;le(this.ra);delete this.ra};B("X.renderer",$);B("X.renderer.prototype.width",$.prototype.width);B("X.renderer.prototype.height",$.prototype.height);B("X.renderer.prototype.canvas",$.prototype.canvas);B("X.renderer.prototype.container",$.prototype.Jf);
B("X.renderer.prototype.camera",$.prototype.Ff);B("X.renderer.prototype.interactor",$.prototype.Zf);B("X.renderer.prototype.resetBoundingBox",$.prototype.Fg);B("X.renderer.prototype.resetViewAndRender",$.prototype.af);B("X.renderer.prototype.init",$.prototype.xa);B("X.renderer.prototype.add",$.prototype.add);B("X.renderer.prototype.onShowtime",$.prototype.yg);B("X.renderer.prototype.get",$.prototype.get);B("X.renderer.prototype.pick",$.prototype.Xe);B("X.renderer.prototype.render",$.prototype.fc);
B("X.renderer.prototype.destroy",$.prototype.Lf);function Vf(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new S(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));h.push(new jd(c.fb(e.Ba(d)),e))}this.i=[];for(var a=a||{},c=new S(a.ud||[0,0,0]),d=a.na||1,f=a.Vd||16,a=a.Zg||8,e=[],h,i=0;i<f;i++)for(var j=0;j<a;j++)h=[],b(i/f,j/a),0<j&&b((i+1)/f,j/a),j<a-1&&b((i+1)/f,(j+1)/a),b(i/f,(j+1)/a),e.push(new nd(h));return pd(e)}C(Vf,U);B("CSG.sphere",Vf);function Wf(a,b){(!x(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid center."));z(b)||g(Error("Invalid radius."));L.call(this);this._className="Sphere";this.j=a;this.kd=b;this.nd=32;this.Cf=16;this.va()}C(Wf,L);Wf.prototype.va=function(){Id(this,new Vf({ud:this.j,na:this.kd,Vd:this.nd,Zg:this.Cf}))};B("X.sphere",Wf);function Xf(a){function b(a,b,d){b=2*b*Math.PI;b=j.Ba(Math.cos(b)).fb(o.Ba(Math.sin(b)));a=c.fb(f.Ba(a)).fb(b.Ba(e));d=b.Ba(1-Math.abs(d)).fb(h.Ba(d));return new jd(a,d)}this.i=[];for(var a=a||{},c=new S(a.start||[0,-1,0]),d=new S(a.end||[0,1,0]),f=d.tb(c),e=a.na||1,a=a.Vd||16,h=f.Ab(),i=0.5<Math.abs(h.y()),j=(new S(i,!i,0)).Bc(h).Ab(),o=j.Bc(h).Ab(),i=new jd(c,h.Mc()),d=new jd(d,h.Ab()),k=[],m=0;m<a;m++){var l=m/a,t=(m+1)/a;k.push(new nd([i,b(0,l,-1),b(0,t,-1)]));k.push(new nd([b(0,t,0),b(0,l,0),
b(1,l,0),b(1,t,0)]));k.push(new nd([d,b(1,t,1),b(1,l,1)]))}return pd(k)}C(Xf,U);B("CSG.cylinder",Xf);function Yf(a,b,c){(!x(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid start position."));(!x(b)||!(b instanceof Array)||3!=b.length)&&g(Error("Invalid end position."));z(c)||g(Error("Invalid radius."));L.call(this);this._className="cylinder";this.Df=a;this.vf=b;this.kd=c;this.nd=32;this.va()}C(Yf,L);Yf.prototype.va=function(){Id(this,new Xf({start:this.Df,end:this.vf,na:this.kd,Vd:this.nd}))};B("X.cylinder",Yf);function Zf(a){this.i=[];var a=a||{},b=new S(a.ud||[0,0,0]),c=!a.na?[1,1,1]:a.na.length?a.na:[a.na,a.na,a.na];return pd([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new nd(a[0].map(function(f){f=new S(b.x()+c[0]*(2*!!(f&1)-1),b.y()+c[1]*(2*!!(f&2)-1),b.b()+c[2]*(2*!!(f&4)-1));return new jd(f,new S(a[1]))}))}))}C(Zf,U);B("CSG.cube",Zf);function $f(a,b,c,d){(!x(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid center."));(!z(b)||!z(c)||!z(d))&&g(Error("Invalid radii."));L.call(this);this._className="cube";this.j=a;this.zf=b;this.Af=c;this.Bf=d;this.Ya=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];this.va()}C($f,L);$f.prototype.va=function(){Id(this,new Zf({ud:this.j,na:[this.zf,this.Af,this.Bf]}))};B("X.cube",$f);
